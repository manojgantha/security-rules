ruleId: aws-compute-ec2-instance-profile-attached
cloudProvider: aws
description: >
  Insecure assets have no IAM profile.
  Secure assets have an attached IAM policy.
insecureAssets:
  noiam: >
    [ {
      "documentId" : "6bKUvPD_Mp-FRSIOBAUUpA",
      "arn" : "noiam",
      "resourceName" : "i-0f84533d53649f6fa",
      "resourceId" : "i-0f84533d53649f6fa",
      "resourceType" : "AWS::EC2::Instance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "00000000000",
      "createdIso" : "2020-08-19T07:38:02Z",
      "updatedIso" : "2022-05-17T13:46:28.174864Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "amiLaunchIndex" : 0,
        "imageId" : "ami-00133f78ad56a5c91",
        "instanceId" : "i-0f84533d53649f6fa",
        "instanceType" : "t2.micro",
        "kernelId" : null,
        "keyName" : "rteam-parag",
        "launchTime" : "2020-08-19T07:38:02Z",
        "monitoring" : {
          "state" : "disabled"
        },
        "placement" : {
          "availabilityZone" : "us-east-2b",
          "affinity" : null,
          "groupName" : "",
          "partitionNumber" : null,
          "hostId" : null,
          "tenancy" : "default",
          "spreadDomain" : null,
          "hostResourceGroupArn" : null
        },
        "platform" : "windows",
        "privateDnsName" : "ip-172-31-26-26.us-east-2.compute.internal",
        "privateIpAddress" : "172.31.26.26",
        "productCodes" : [ ],
        "publicDnsName" : "",
        "publicIpAddress" : null,
        "ramdiskId" : null,
        "state" : {
          "code" : 80,
          "name" : "stopped"
        },
        "stateTransitionReason" : "User initiated (2020-08-25 16:04:54 GMT)",
        "subnetId" : "subnet-970130ed",
        "vpcId" : "vpc-6487540f",
        "architecture" : "x86_64",
        "blockDeviceMappings" : [ {
          "deviceName" : "/dev/sda1",
          "ebs" : {
            "attachTime" : "2020-08-19T07:38:03Z",
            "deleteOnTermination" : true,
            "status" : "attached",
            "volumeId" : "vol-083ec02add94f63cf"
          }
        } ],
        "clientToken" : "",
        "ebsOptimized" : false,
        "enaSupport" : true,
        "hypervisor" : "xen",
        "iamInstanceProfile" : null,
        "instanceLifecycle" : null,
        "elasticGpuAssociations" : null,
        "elasticInferenceAcceleratorAssociations" : null,
        "networkInterfaces" : [ {
          "association" : null,
          "attachment" : {
            "attachTime" : "2020-08-19T07:38:02Z",
            "attachmentId" : "eni-attach-0dce258962314165e",
            "deleteOnTermination" : true,
            "deviceIndex" : 0,
            "status" : "attached",
            "networkCardIndex" : 0
          },
          "description" : "",
          "groups" : [ {
            "groupName" : "nmap-nc-telnet-client-workstation-only",
            "groupId" : "sg-0acf626d3df96da7c"
          } ],
          "ipv6Addresses" : [ ],
          "macAddress" : "06:ce:7e:ae:99:10",
          "networkInterfaceId" : "eni-0738d20df8b984c1c",
          "ownerId" : "00000000000",
          "privateDnsName" : "ip-172-31-26-26.us-east-2.compute.internal",
          "privateIpAddress" : "172.31.26.26",
          "privateIpAddresses" : [ {
            "association" : null,
            "primary" : true,
            "privateDnsName" : "ip-172-31-26-26.us-east-2.compute.internal",
            "privateIpAddress" : "172.31.26.26"
          } ],
          "sourceDestCheck" : true,
          "status" : "in-use",
          "subnetId" : "subnet-970130ed",
          "vpcId" : "vpc-6487540f",
          "interfaceType" : "interface",
          "ipv4Prefixes" : null,
          "ipv6Prefixes" : null
        } ],
        "outpostArn" : null,
        "rootDeviceName" : "/dev/sda1",
        "rootDeviceType" : "ebs",
        "securityGroups" : [ {
          "groupName" : "nmap-nc-telnet-client-workstation-only",
          "groupId" : "sg-0acf626d3df96da7c"
        } ],
        "sourceDestCheck" : true,
        "spotInstanceRequestId" : null,
        "sriovNetSupport" : null,
        "stateReason" : {
          "code" : "Client.UserInitiatedShutdown",
          "message" : "Client.UserInitiatedShutdown: User initiated shutdown"
        },
        "tags" : [ {
          "key" : "Name",
          "value" : "Parag_Windows_DMZ"
        } ],
        "virtualizationType" : "hvm",
        "cpuOptions" : {
          "coreCount" : 1,
          "threadsPerCore" : 1
        },
        "capacityReservationId" : null,
        "capacityReservationSpecification" : {
          "capacityReservationPreference" : "open",
          "capacityReservationTarget" : null
        },
        "hibernationOptions" : {
          "configured" : false
        },
        "licenses" : null,
        "metadataOptions" : {
          "state" : "applied",
          "httpTokens" : "optional",
          "httpPutResponseHopLimit" : 1,
          "httpEndpoint" : "enabled",
          "httpProtocolIpv6" : "disabled"
        },
        "enclaveOptions" : {
          "enabled" : false
        },
        "bootMode" : null,
        "platformDetails" : "Windows",
        "usageOperation" : "RunInstances:0002",
        "usageOperationUpdateTime" : "2020-08-19T07:38:02Z",
        "privateDnsNameOptions" : {
          "hostnameType" : null,
          "enableResourceNameDnsARecord" : null,
          "enableResourceNameDnsAAAARecord" : null
        },
        "ipv6Address" : null
      },
      "supplementaryConfiguration" : {
        "awsBackupJobs" : [ ]
      },
      "tags" : {
        "Name" : "Parag_Windows_DMZ"
      },
      "discoveryMeta" : { }
    }]
secureAssets:
  iam: >
    [ {
      "documentId" : "6bKUvPD_Mp-FRSIOBAUUpA",
      "arn" : "iam",
      "resourceName" : "i-0f84533d53649f6fa",
      "resourceId" : "i-0f84533d53649f6fa",
      "resourceType" : "AWS::EC2::Instance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "00000000000",
      "createdIso" : "2020-08-19T07:38:02Z",
      "updatedIso" : "2022-05-17T13:46:28.174864Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "amiLaunchIndex" : 0,
        "imageId" : "ami-00133f78ad56a5c91",
        "instanceId" : "i-0f84533d53649f6fa",
        "instanceType" : "t2.micro",
        "kernelId" : null,
        "keyName" : "rteam-parag",
        "launchTime" : "2020-08-19T07:38:02Z",
        "monitoring" : {
          "state" : "disabled"
        },
        "placement" : {
          "availabilityZone" : "us-east-2b",
          "affinity" : null,
          "groupName" : "",
          "partitionNumber" : null,
          "hostId" : null,
          "tenancy" : "default",
          "spreadDomain" : null,
          "hostResourceGroupArn" : null
        },
        "platform" : "windows",
        "privateDnsName" : "ip-172-31-26-26.us-east-2.compute.internal",
        "privateIpAddress" : "172.31.26.26",
        "productCodes" : [ ],
        "publicDnsName" : "",
        "publicIpAddress" : null,
        "ramdiskId" : null,
        "state" : {
          "code" : 80,
          "name" : "stopped"
        },
        "stateTransitionReason" : "User initiated (2020-08-25 16:04:54 GMT)",
        "subnetId" : "subnet-970130ed",
        "vpcId" : "vpc-6487540f",
        "architecture" : "x86_64",
        "blockDeviceMappings" : [ {
          "deviceName" : "/dev/sda1",
          "ebs" : {
            "attachTime" : "2020-08-19T07:38:03Z",
            "deleteOnTermination" : true,
            "status" : "attached",
            "volumeId" : "vol-083ec02add94f63cf"
          }
        } ],
        "clientToken" : "",
        "ebsOptimized" : false,
        "enaSupport" : true,
        "hypervisor" : "xen",
        "iamInstanceProfile" : {
               "arn" : "arn:aws:iam::00000000000:instance-profile/aws-elasticbeanstalk-ec2-role",
               "id" : "AIPAW45VVVVV5AU52GGWW"
          },
        "instanceLifecycle" : null,
        "elasticGpuAssociations" : null,
        "elasticInferenceAcceleratorAssociations" : null,
        "networkInterfaces" : [ {
          "association" : null,
          "attachment" : {
            "attachTime" : "2020-08-19T07:38:02Z",
            "attachmentId" : "eni-attach-0dce258962314165e",
            "deleteOnTermination" : true,
            "deviceIndex" : 0,
            "status" : "attached",
            "networkCardIndex" : 0
          },
          "description" : "",
          "groups" : [ {
            "groupName" : "nmap-nc-telnet-client-workstation-only",
            "groupId" : "sg-0acf626d3df96da7c"
          } ],
          "ipv6Addresses" : [ ],
          "macAddress" : "06:ce:7e:ae:99:10",
          "networkInterfaceId" : "eni-0738d20df8b984c1c",
          "ownerId" : "00000000000",
          "privateDnsName" : "ip-172-31-26-26.us-east-2.compute.internal",
          "privateIpAddress" : "172.31.26.26",
          "privateIpAddresses" : [ {
            "association" : null,
            "primary" : true,
            "privateDnsName" : "ip-172-31-26-26.us-east-2.compute.internal",
            "privateIpAddress" : "172.31.26.26"
          } ],
          "sourceDestCheck" : true,
          "status" : "in-use",
          "subnetId" : "subnet-970130ed",
          "vpcId" : "vpc-6487540f",
          "interfaceType" : "interface",
          "ipv4Prefixes" : null,
          "ipv6Prefixes" : null
        } ],
        "outpostArn" : null,
        "rootDeviceName" : "/dev/sda1",
        "rootDeviceType" : "ebs",
        "securityGroups" : [ {
          "groupName" : "nmap-nc-telnet-client-workstation-only",
          "groupId" : "sg-0acf626d3df96da7c"
        } ],
        "sourceDestCheck" : true,
        "spotInstanceRequestId" : null,
        "sriovNetSupport" : null,
        "stateReason" : {
          "code" : "Client.UserInitiatedShutdown",
          "message" : "Client.UserInitiatedShutdown: User initiated shutdown"
        },
        "tags" : [ {
          "key" : "Name",
          "value" : "Parag_Windows_DMZ"
        } ],
        "virtualizationType" : "hvm",
        "cpuOptions" : {
          "coreCount" : 1,
          "threadsPerCore" : 1
        },
        "capacityReservationId" : null,
        "capacityReservationSpecification" : {
          "capacityReservationPreference" : "open",
          "capacityReservationTarget" : null
        },
        "hibernationOptions" : {
          "configured" : false
        },
        "licenses" : null,
        "metadataOptions" : {
          "state" : "applied",
          "httpTokens" : "optional",
          "httpPutResponseHopLimit" : 1,
          "httpEndpoint" : "enabled",
          "httpProtocolIpv6" : "disabled"
        },
        "enclaveOptions" : {
          "enabled" : false
        },
        "bootMode" : null,
        "platformDetails" : "Windows",
        "usageOperation" : "RunInstances:0002",
        "usageOperationUpdateTime" : "2020-08-19T07:38:02Z",
        "privateDnsNameOptions" : {
          "hostnameType" : null,
          "enableResourceNameDnsARecord" : null,
          "enableResourceNameDnsAAAARecord" : null
        },
        "ipv6Address" : null
      },
      "supplementaryConfiguration" : {
        "awsBackupJobs" : [ ]
      },
      "tags" : {
        "Name" : "Parag_Windows_DMZ"
      },
      "discoveryMeta" : { }
    }]