ruleId: aws-network-and-content-delivery-cloudfront-origin-failover-enabled.yaml
cloudProvider: aws
description: >
  Insecure assets have none or less than two origin groups
  Secure assets have at least 2 origin groups
insecureAssets:
  noorigin: >
    [ {
      "documentId" : "yHbC7rRpOnSi4RkJomU6dg",
      "arn" : "noorigin",
      "resourceName" : "d14lty3fhvnvvm.cloudfront.net",
      "resourceId" : "E3ND8W6R0QD6P2",
      "resourceType" : "AWS::CloudFront::Distribution",
      "awsRegion" : "aws-global",
      "awsAccountId" : "00000000000",
      "createdIso" : null,
      "updatedIso" : "2022-05-19T15:21:52.328874Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "id" : "E3ND8W6R0QD6P2",
        "arn" : "arn:aws:cloudfront::476384142167:distribution/E3ND8W6R0QD6P2",
        "status" : "Deployed",
        "lastModifiedTime" : "2022-02-28T15:45:45.752Z",
        "domainName" : "d14lty3fhvnvvm.cloudfront.net",
        "aliases" : {
          "quantity" : 0,
          "items" : null
        },
        "origins" : {
          "quantity" : 1,
          "items" : [ {
            "id" : "taratestcompliant.s3.us-east-2.amazonaws.com",
            "domainName" : "taratestcompliant.s3.us-east-2.amazonaws.com",
            "originPath" : "",
            "customHeaders" : {
              "quantity" : 0,
              "items" : null
            },
            "s3OriginConfig" : {
              "originAccessIdentity" : "origin-access-identity/cloudfront/E3D6R4SZ1P4CO1"
            },
            "customOriginConfig" : null,
            "connectionAttempts" : 3,
            "connectionTimeout" : 10,
            "originShield" : {
              "enabled" : true,
              "originShieldRegion" : "us-east-1"
            }
          } ]
        },
        "originGroups" : {
          "quantity" : 0,
          "items" : null
        },
        "defaultCacheBehavior" : {
          "targetOriginId" : "taratestcompliant.s3.us-east-2.amazonaws.com",
          "trustedSigners" : {
            "enabled" : false,
            "quantity" : 0,
            "items" : null
          },
          "trustedKeyGroups" : {
            "enabled" : false,
            "quantity" : 0,
            "items" : null
          },
          "viewerProtocolPolicy" : "redirect-to-https",
          "allowedMethods" : {
            "quantity" : 2,
            "items" : [ "HEAD", "GET" ],
            "cachedMethods" : {
              "quantity" : 2,
              "items" : [ "HEAD", "GET" ]
            }
          },
          "smoothStreaming" : false,
          "compress" : true,
          "lambdaFunctionAssociations" : {
            "quantity" : 0,
            "items" : null
          },
          "functionAssociations" : {
            "quantity" : 0,
            "items" : null
          },
          "fieldLevelEncryptionId" : "",
          "realtimeLogConfigArn" : "arn:aws:cloudfront::476384142167:realtime-log-config/test",
          "cachePolicyId" : "658327ea-f89d-4fab-a63d-7e88639e58f6",
          "originRequestPolicyId" : null,
          "responseHeadersPolicyId" : null,
          "forwardedValues" : null,
          "minTTL" : null,
          "defaultTTL" : null,
          "maxTTL" : null
        },
        "cacheBehaviors" : {
          "quantity" : 0,
          "items" : null
        },
        "customErrorResponses" : {
          "quantity" : 0,
          "items" : null
        },
        "comment" : "",
        "priceClass" : "PriceClass_All",
        "enabled" : true,
        "viewerCertificate" : {
          "cloudFrontDefaultCertificate" : true,
          "iamCertificateId" : null,
          "acmCertificateArn" : null,
          "sslSupportMethod" : "vip",
          "minimumProtocolVersion" : "TLSv1",
          "certificate" : null,
          "certificateSource" : "cloudfront"
        },
        "restrictions" : {
          "geoRestriction" : {
            "restrictionType" : "none",
            "quantity" : 0,
            "items" : null
          }
        },
        "webACLId" : "arn:aws:wafv2:us-east-1:476384142167:global/webacl/testtara/47c317b9-b514-4f4b-a1da-d38fce3e7d3c",
        "httpVersion" : "HTTP2",
        "isIPV6Enabled" : true,
        "aliasICPRecordals" : null
      },
      "supplementaryConfiguration" : { },
      "tags" : { },
      "discoveryMeta" : { }
    }]
secureAssets:
  origin: >
    [ {
      "documentId" : "AtWm1hoKM4CVSgeZuh_Y0Q",
      "arn" : "origin",
      "resourceName" : "d2gifkoquq9v06.cloudfront.net",
      "resourceId" : "E1M1WGYVFLQMUD",
      "resourceType" : "AWS::CloudFront::Distribution",
      "awsRegion" : "aws-global",
      "awsAccountId" : "00000000000",
      "createdIso" : null,
      "updatedIso" : "2022-05-19T15:21:52.524400Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "id" : "E1M1WGYVFLQMUD",
        "arn" : "arn:aws:cloudfront::476384142167:distribution/E1M1WGYVFLQMUD",
        "status" : "InProgress",
        "lastModifiedTime" : "2022-05-19T15:21:39.836Z",
        "domainName" : "d2gifkoquq9v06.cloudfront.net",
        "aliases" : {
          "quantity" : 0,
          "items" : null
        },
        "origins" : {
          "quantity" : 2,
          "items" : [ {
            "id" : "mness-testing-bucket.s3.us-east-1.amazonaws.com",
            "domainName" : "mness-testing-bucket.s3.us-east-1.amazonaws.com",
            "originPath" : "",
            "customHeaders" : {
              "quantity" : 0,
              "items" : null
            },
            "s3OriginConfig" : {
              "originAccessIdentity" : ""
            },
            "customOriginConfig" : null,
            "connectionAttempts" : 3,
            "connectionTimeout" : 10,
            "originShield" : {
              "enabled" : false,
              "originShieldRegion" : null
            }
          }, {
            "id" : "testforrules.us-east-2.elb.amazonaws.com",
            "domainName" : "test-classic-lb-1544868284.us-east-2.elb.amazonaws.com",
            "originPath" : "/test.com",
            "customHeaders" : {
              "quantity" : 0,
              "items" : null
            },
            "s3OriginConfig" : null,
            "customOriginConfig" : {
              "httpPort" : 80,
              "httpsPort" : 443,
              "originProtocolPolicy" : "http-only",
              "originSslProtocols" : {
                "quantity" : 3,
                "items" : [ "TLSv1", "TLSv1.1", "TLSv1.2" ]
              },
              "originReadTimeout" : 30,
              "originKeepaliveTimeout" : 5
            },
            "connectionAttempts" : 3,
            "connectionTimeout" : 10,
            "originShield" : {
              "enabled" : true,
              "originShieldRegion" : "us-east-1"
            }
          } ]
        },
        "originGroups" : {
          "quantity" : 1,
          "items" : [ {
            "id" : "testgroup",
            "failoverCriteria" : {
              "statusCodes" : {
                "quantity" : 4,
                "items" : [ 400, 403, 404, 500 ]
              }
            },
            "members" : {
              "quantity" : 2,
              "items" : [ {
                "originId" : "mness-testing-bucket.s3.us-east-1.amazonaws.com"
              }, {
                "originId" : "testforrules.us-east-2.elb.amazonaws.com"
              } ]
            }
          } ]
        },
        "defaultCacheBehavior" : {
          "targetOriginId" : "testforrules.us-east-2.elb.amazonaws.com",
          "trustedSigners" : {
            "enabled" : false,
            "quantity" : 0,
            "items" : null
          },
          "trustedKeyGroups" : {
            "enabled" : false,
            "quantity" : 0,
            "items" : null
          },
          "viewerProtocolPolicy" : "allow-all",
          "allowedMethods" : {
            "quantity" : 2,
            "items" : [ "HEAD", "GET" ],
            "cachedMethods" : {
              "quantity" : 2,
              "items" : [ "HEAD", "GET" ]
            }
          },
          "smoothStreaming" : false,
          "compress" : true,
          "lambdaFunctionAssociations" : {
            "quantity" : 0,
            "items" : null
          },
          "functionAssociations" : {
            "quantity" : 0,
            "items" : null
          },
          "fieldLevelEncryptionId" : "",
          "realtimeLogConfigArn" : "arn:aws:cloudfront::476384142167:realtime-log-config/test",
          "cachePolicyId" : "658327ea-f89d-4fab-a63d-7e88639e58f6",
          "originRequestPolicyId" : "59781a5b-3903-41f3-afcb-af62929ccde1",
          "responseHeadersPolicyId" : "67f7725c-6f97-4210-82d7-5512b31e9d03",
          "forwardedValues" : null,
          "minTTL" : null,
          "defaultTTL" : null,
          "maxTTL" : null
        },
        "cacheBehaviors" : {
          "quantity" : 0,
          "items" : null
        },
        "customErrorResponses" : {
          "quantity" : 0,
          "items" : null
        },
        "comment" : "",
        "priceClass" : "PriceClass_All",
        "enabled" : true,
        "viewerCertificate" : {
          "cloudFrontDefaultCertificate" : true,
          "iamCertificateId" : null,
          "acmCertificateArn" : null,
          "sslSupportMethod" : "vip",
          "minimumProtocolVersion" : "TLSv1",
          "certificate" : null,
          "certificateSource" : "cloudfront"
        },
        "restrictions" : {
          "geoRestriction" : {
            "restrictionType" : "none",
            "quantity" : 0,
            "items" : null
          }
        },
        "webACLId" : "arn:aws:wafv2:us-east-1:476384142167:global/webacl/testtara/47c317b9-b514-4f4b-a1da-d38fce3e7d3c",
        "httpVersion" : "HTTP2",
        "isIPV6Enabled" : true,
        "aliasICPRecordals" : null
      },
      "supplementaryConfiguration" : { },
      "tags" : { },
      "discoveryMeta" : { }
    } ]
