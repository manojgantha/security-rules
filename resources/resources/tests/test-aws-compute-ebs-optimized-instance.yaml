ruleId: aws-compute-ebs-optimized-instance
cloudProvider: aws
description: >
  Insecure assets do not have EBS optimization enabled.
  Secure assets  have EBS optimization  enabled.
insecureAssets:
  noopt: >
    [ {
      "documentId" : "yrbiPogxO-SW36Xh_Rktcw",
      "arn" : "noopt",
      "resourceName" : "i-06bf26ad57f6be8d1",
      "resourceId" : "i-06bf26ad57f6be8d1",
      "resourceType" : "AWS::EC2::Instance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "00000000000",
      "createdIso" : "2021-11-10T15:40:03Z",
      "updatedIso" : "2022-05-17T14:43:46.831436Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "amiLaunchIndex" : 0,
        "imageId" : "ami-026fd1c08393e4a30",
        "instanceId" : "i-06bf26ad57f6be8d1",
        "instanceType" : "m5.large",
        "kernelId" : null,
        "keyName" : "rteam-parag",
        "launchTime" : "2021-11-10T15:40:03Z",
        "monitoring" : {
          "state" : "disabled"
        },
        "placement" : {
          "availabilityZone" : "us-east-2a",
          "affinity" : null,
          "groupName" : "",
          "partitionNumber" : null,
          "hostId" : null,
          "tenancy" : "default",
          "spreadDomain" : null,
          "hostResourceGroupArn" : null
        },
        "platform" : "windows",
        "privateDnsName" : "ip-172-31-8-245.us-east-2.compute.internal",
        "privateIpAddress" : "172.31.8.245",
        "productCodes" : [ ],
        "publicDnsName" : "",
        "publicIpAddress" : null,
        "ramdiskId" : null,
        "state" : {
          "code" : 80,
          "name" : "stopped"
        },
        "stateTransitionReason" : "User initiated (2021-11-12 18:31:08 GMT)",
        "subnetId" : "subnet-249c674f",
        "vpcId" : "vpc-6487540f",
        "architecture" : "x86_64",
        "blockDeviceMappings" : [ {
          "deviceName" : "/dev/sda1",
          "ebs" : {
            "attachTime" : "2020-05-06T11:17:14Z",
            "deleteOnTermination" : true,
            "status" : "attached",
            "volumeId" : "vol-0b9fea53588c00f21"
          }
        } ],
        "clientToken" : "158876385112224128",
        "ebsOptimized" : false,
        "enaSupport" : true,
        "hypervisor" : "xen",
        "iamInstanceProfile" : null,
        "instanceLifecycle" : null,
        "elasticGpuAssociations" : null,
        "elasticInferenceAcceleratorAssociations" : null,
        "networkInterfaces" : [ {
          "association" : null,
          "attachment" : {
            "attachTime" : "2020-05-06T11:17:13Z",
            "attachmentId" : "eni-attach-004c82e4c9d77b9cd",
            "deleteOnTermination" : true,
            "deviceIndex" : 0,
            "status" : "attached",
            "networkCardIndex" : 0
          },
          "description" : "Primary network interface",
          "groups" : [ {
            "groupName" : "Private-DMAP-T100",
            "groupId" : "sg-0320abd8aeb0ae618"
          } ],
          "ipv6Addresses" : [ ],
          "macAddress" : "02:76:0b:1d:c0:ba",
          "networkInterfaceId" : null,
          "ownerId" : "00000000000",
          "privateDnsName" : "ip-172-31-8-245.us-east-2.compute.internal",
          "privateIpAddress" : "172.31.8.245",
          "privateIpAddresses" : [ {
            "association" : null,
            "primary" : true,
            "privateDnsName" : "ip-172-31-8-245.us-east-2.compute.internal",
            "privateIpAddress" : "172.31.8.245"
          } ],
          "sourceDestCheck" : true,
          "status" : "in-use",
          "subnetId" : "subnet-249c674f",
          "vpcId" : "vpc-6487540f",
          "interfaceType" : "interface",
          "ipv4Prefixes" : null,
          "ipv6Prefixes" : null
        } ],
        "outpostArn" : null,
        "rootDeviceName" : "/dev/sda1",
        "rootDeviceType" : "ebs",
        "securityGroups" : [ {
          "groupName" : "Private-DMAP-T100",
          "groupId" : "sg-0320abd8aeb0ae618"
        } ],
        "sourceDestCheck" : true,
        "spotInstanceRequestId" : null,
        "sriovNetSupport" : null,
        "stateReason" : {
          "code" : "Client.UserInitiatedShutdown",
          "message" : "Client.UserInitiatedShutdown: User initiated shutdown"
        },
        "tags" : [ {
          "key" : "Name",
          "value" : "MSSQL_2016_STD"
        }, {
          "key" : "port",
          "value" : "1433"
        }, {
          "key" : "app_name",
          "value" : "Microsoft SQL"
        }, {
          "key" : "app_version",
          "value" : "2016"
        } ],
        "virtualizationType" : "hvm",
        "cpuOptions" : {
          "coreCount" : 1,
          "threadsPerCore" : 2
        },
        "capacityReservationId" : null,
        "capacityReservationSpecification" : {
          "capacityReservationPreference" : "open",
          "capacityReservationTarget" : null
        },
        "hibernationOptions" : {
          "configured" : false
        },
        "licenses" : null,
        "metadataOptions" : {
          "state" : "applied",
          "httpTokens" : "optional",
          "httpPutResponseHopLimit" : 1,
          "httpEndpoint" : "enabled",
          "httpProtocolIpv6" : "disabled"
        },
        "enclaveOptions" : {
          "enabled" : false
        },
        "bootMode" : null,
        "platformDetails" : "Windows with SQL Server Standard",
        "usageOperation" : "RunInstances:0006",
        "usageOperationUpdateTime" : "2020-05-06T11:17:13Z",
        "privateDnsNameOptions" : {
          "hostnameType" : null,
          "enableResourceNameDnsARecord" : null,
          "enableResourceNameDnsAAAARecord" : null
        },
        "ipv6Address" : null
      },
      "supplementaryConfiguration" : {
        "awsBackupJobs" : [ ]
      },
      "tags" : {
        "app_name" : "Microsoft SQL",
        "app_version" : "2016",
        "port" : "1433",
        "Name" : "MSSQL_2016_STD"
      },
      "discoveryMeta" : { }
    }]
secureAssets:
  opt: >
    [ {
      "documentId" : "yrbiPogxO-SW36Xh_Rktcw",
      "arn" : "opt",
      "resourceName" : "i-06bf26ad57f6be8d1",
      "resourceId" : "i-06bf26ad57f6be8d1",
      "resourceType" : "AWS::EC2::Instance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "00000000000",
      "createdIso" : "2021-11-10T15:40:03Z",
      "updatedIso" : "2022-05-17T14:43:46.831436Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "amiLaunchIndex" : 0,
        "imageId" : "ami-026fd1c08393e4a30",
        "instanceId" : "i-06bf26ad57f6be8d1",
        "instanceType" : "m5.large",
        "kernelId" : null,
        "keyName" : "rteam-parag",
        "launchTime" : "2021-11-10T15:40:03Z",
        "monitoring" : {
          "state" : "disabled"
        },
        "placement" : {
          "availabilityZone" : "us-east-2a",
          "affinity" : null,
          "groupName" : "",
          "partitionNumber" : null,
          "hostId" : null,
          "tenancy" : "default",
          "spreadDomain" : null,
          "hostResourceGroupArn" : null
        },
        "platform" : "windows",
        "privateDnsName" : "ip-172-31-8-245.us-east-2.compute.internal",
        "privateIpAddress" : "172.31.8.245",
        "productCodes" : [ ],
        "publicDnsName" : "",
        "publicIpAddress" : null,
        "ramdiskId" : null,
        "state" : {
          "code" : 80,
          "name" : "stopped"
        },
        "stateTransitionReason" : "User initiated (2021-11-12 18:31:08 GMT)",
        "subnetId" : "subnet-249c674f",
        "vpcId" : "vpc-6487540f",
        "architecture" : "x86_64",
        "blockDeviceMappings" : [ {
          "deviceName" : "/dev/sda1",
          "ebs" : {
            "attachTime" : "2020-05-06T11:17:14Z",
            "deleteOnTermination" : true,
            "status" : "attached",
            "volumeId" : "vol-0b9fea53588c00f21"
          }
        } ],
        "clientToken" : "158876385112224128",
        "ebsOptimized" : true,
        "enaSupport" : true,
        "hypervisor" : "xen",
        "iamInstanceProfile" : null,
        "instanceLifecycle" : null,
        "elasticGpuAssociations" : null,
        "elasticInferenceAcceleratorAssociations" : null,
        "networkInterfaces" : [ {
          "association" : null,
          "attachment" : {
            "attachTime" : "2020-05-06T11:17:13Z",
            "attachmentId" : "eni-attach-004c82e4c9d77b9cd",
            "deleteOnTermination" : true,
            "deviceIndex" : 0,
            "status" : "attached",
            "networkCardIndex" : 0
          },
          "description" : "Primary network interface",
          "groups" : [ {
            "groupName" : "Private-DMAP-T100",
            "groupId" : "sg-0320abd8aeb0ae618"
          } ],
          "ipv6Addresses" : [ ],
          "macAddress" : "02:76:0b:1d:c0:ba",
          "networkInterfaceId" : "eni-047204387256a007c",
          "ownerId" : "00000000000",
          "privateDnsName" : "ip-172-31-8-245.us-east-2.compute.internal",
          "privateIpAddress" : "172.31.8.245",
          "privateIpAddresses" : [ {
            "association" : null,
            "primary" : true,
            "privateDnsName" : "ip-172-31-8-245.us-east-2.compute.internal",
            "privateIpAddress" : "172.31.8.245"
          } ],
          "sourceDestCheck" : true,
          "status" : "in-use",
          "subnetId" : "subnet-249c674f",
          "vpcId" : "vpc-6487540f",
          "interfaceType" : "interface",
          "ipv4Prefixes" : null,
          "ipv6Prefixes" : null
        } ],
        "outpostArn" : null,
        "rootDeviceName" : "/dev/sda1",
        "rootDeviceType" : "ebs",
        "securityGroups" : [ {
          "groupName" : "Private-DMAP-T100",
          "groupId" : "sg-0320abd8aeb0ae618"
        } ],
        "sourceDestCheck" : true,
        "spotInstanceRequestId" : null,
        "sriovNetSupport" : null,
        "stateReason" : {
          "code" : "Client.UserInitiatedShutdown",
          "message" : "Client.UserInitiatedShutdown: User initiated shutdown"
        },
        "tags" : [ {
          "key" : "Name",
          "value" : "MSSQL_2016_STD"
        }, {
          "key" : "port",
          "value" : "1433"
        }, {
          "key" : "app_name",
          "value" : "Microsoft SQL"
        }, {
          "key" : "app_version",
          "value" : "2016"
        } ],
        "virtualizationType" : "hvm",
        "cpuOptions" : {
          "coreCount" : 1,
          "threadsPerCore" : 2
        },
        "capacityReservationId" : null,
        "capacityReservationSpecification" : {
          "capacityReservationPreference" : "open",
          "capacityReservationTarget" : null
        },
        "hibernationOptions" : {
          "configured" : false
        },
        "licenses" : null,
        "metadataOptions" : {
          "state" : "applied",
          "httpTokens" : "optional",
          "httpPutResponseHopLimit" : 1,
          "httpEndpoint" : "enabled",
          "httpProtocolIpv6" : "disabled"
        },
        "enclaveOptions" : {
          "enabled" : false
        },
        "bootMode" : null,
        "platformDetails" : "Windows with SQL Server Standard",
        "usageOperation" : "RunInstances:0006",
        "usageOperationUpdateTime" : "2020-05-06T11:17:13Z",
        "privateDnsNameOptions" : {
          "hostnameType" : null,
          "enableResourceNameDnsARecord" : null,
          "enableResourceNameDnsAAAARecord" : null
        },
        "ipv6Address" : null
      },
      "supplementaryConfiguration" : {
        "awsBackupJobs" : [ ]
      },
      "tags" : {
        "app_name" : "Microsoft SQL",
        "app_version" : "2016",
        "port" : "1433",
        "Name" : "MSSQL_2016_STD"
      },
      "discoveryMeta" : { }

    }]
