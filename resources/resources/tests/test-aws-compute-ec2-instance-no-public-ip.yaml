ruleId: aws-compute-ec2-instance-no-public-ip
cloudProvider: aws
description: >
  Insecure assets have a public ip.
  Secure assets no public ip.
insecureAssets:
  ip: >
    [ {
        "documentId" : "-lKlWNJBMeC3bF_rNs8zww",
        "arn" : "ip",
        "resourceName" : "i-0855e9c650df00b12",
        "resourceId" : "i-0855e9c650df00b12",
        "resourceType" : "AWS::EC2::Instance",
        "awsRegion" : "us-east-1",
        "awsAccountId" : "00000000000",
        "createdIso" : "2022-05-17T13:44:27Z",
        "updatedIso" : "2022-05-17T13:45:11.292132Z",
        "discoverySessionId" : null,
        "maxSizeInBytes" : null,
        "sizeInBytes" : null,
        "configuration" : {
          "amiLaunchIndex" : 0,
          "imageId" : "ami-0022f774911c1d690",
          "instanceId" : "i-0855e9c650df00b12",
          "instanceType" : "t2.micro",
          "kernelId" : null,
          "keyName" : "tara",
          "launchTime" : "2022-05-17T13:44:27Z",
          "monitoring" : {
            "state" : "disabled"
          },
          "placement" : {
            "availabilityZone" : "us-east-1a",
            "affinity" : null,
            "groupName" : "",
            "partitionNumber" : null,
            "hostId" : null,
            "tenancy" : "default",
            "spreadDomain" : null,
            "hostResourceGroupArn" : null
          },
          "platform" : null,
          "privateDnsName" : "ip-172-31-26-64.ec2.internal",
          "privateIpAddress" : "172.31.26.64",
          "productCodes" : [ ],
          "publicDnsName" : "",
          "publicIpAddress" : "3.226.37.174",
          "ramdiskId" : null,
          "state" : {
            "code" : 16,
            "name" : "running"
          },
          "stateTransitionReason" : "",
          "subnetId" : "subnet-5be56c16",
          "vpcId" : "vpc-00e2e87a",
          "architecture" : "x86_64",
          "blockDeviceMappings" : [ {
            "deviceName" : "/dev/xvda",
            "ebs" : {
              "attachTime" : "2022-05-17T13:44:27Z",
              "deleteOnTermination" : true,
              "status" : "attached",
              "volumeId" : "vol-09f976aeb594f3319"
            }
          } ],
          "clientToken" : "",
          "ebsOptimized" : false,
          "enaSupport" : true,
          "hypervisor" : "xen",
          "iamInstanceProfile" : null,
          "instanceLifecycle" : null,
          "elasticGpuAssociations" : null,
          "elasticInferenceAcceleratorAssociations" : null,
          "networkInterfaces" : [ {
            "association" : null,
            "attachment" : {
              "attachTime" : "2022-05-17T13:44:27Z",
              "attachmentId" : "eni-attach-079904a417bab978c",
              "deleteOnTermination" : true,
              "deviceIndex" : 0,
              "status" : "attached",
              "networkCardIndex" : 0
            },
            "description" : "",
            "groups" : [ {
              "groupName" : "launch-wizard-1",
              "groupId" : "sg-0a8693adf81ee3db0"
            } ],
            "ipv6Addresses" : [ ],
            "macAddress" : "0a:d4:eb:fb:17:df",
            "networkInterfaceId" : "eni-07c6cc6dfc72f9878",
            "ownerId" : "00000000000",
            "privateDnsName" : "ip-172-31-26-64.ec2.internal",
            "privateIpAddress" : "172.31.26.64",
            "privateIpAddresses" : [ {
              "association" : null,
              "primary" : true,
              "privateDnsName" : "ip-172-31-26-64.ec2.internal",
              "privateIpAddress" : "172.31.26.64"
            } ],
            "sourceDestCheck" : true,
            "status" : "in-use",
            "subnetId" : "subnet-5be56c16",
            "vpcId" : "vpc-00e2e87a",
            "interfaceType" : "interface",
            "ipv4Prefixes" : null,
            "ipv6Prefixes" : null
          } ],
          "outpostArn" : null,
          "rootDeviceName" : "/dev/xvda",
          "rootDeviceType" : "ebs",
          "securityGroups" : [ {
            "groupName" : "launch-wizard-1",
            "groupId" : "sg-0a8693adf81ee3db0"
          } ],
          "sourceDestCheck" : true,
          "spotInstanceRequestId" : null,
          "sriovNetSupport" : null,
          "stateReason" : null,
          "tags" : [ {
            "key" : "Name",
            "value" : "test2nopublic"
          } ],
          "virtualizationType" : "hvm",
          "cpuOptions" : {
            "coreCount" : 1,
            "threadsPerCore" : 1
          },
          "capacityReservationId" : null,
          "capacityReservationSpecification" : {
            "capacityReservationPreference" : "open",
            "capacityReservationTarget" : null
          },
          "hibernationOptions" : {
            "configured" : false
          },
          "licenses" : null,
          "metadataOptions" : {
            "state" : "applied",
            "httpTokens" : "optional",
            "httpPutResponseHopLimit" : 1,
            "httpEndpoint" : "enabled",
            "httpProtocolIpv6" : "disabled"
          },
          "enclaveOptions" : {
            "enabled" : false
          },
          "bootMode" : null,
          "platformDetails" : "Linux/UNIX",
          "usageOperation" : "RunInstances",
          "usageOperationUpdateTime" : "2022-05-17T13:44:27Z",
          "privateDnsNameOptions" : {
            "hostnameType" : "ip-name",
            "enableResourceNameDnsARecord" : true,
            "enableResourceNameDnsAAAARecord" : false
          },
          "ipv6Address" : null
        },
        "supplementaryConfiguration" : {
          "awsBackupJobs" : [ ]
        },
        "tags" : {
          "Name" : "test2nopublic"
        },
        "discoveryMeta" : { }
      }]
secureAssets:
  noip: >
    [ {
        "documentId" : "-lKlWNJBMeC3bF_rNs8zww",
        "arn" : "noip",
        "resourceName" : "i-0855e9c650df00b12",
        "resourceId" : "i-0855e9c650df00b12",
        "resourceType" : "AWS::EC2::Instance",
        "awsRegion" : "us-east-1",
        "awsAccountId" : "00000000000",
        "createdIso" : "2022-05-17T13:44:27Z",
        "updatedIso" : "2022-05-17T13:45:11.292132Z",
        "discoverySessionId" : null,
        "maxSizeInBytes" : null,
        "sizeInBytes" : null,
        "configuration" : {
          "amiLaunchIndex" : 0,
          "imageId" : "ami-0022f774911c1d690",
          "instanceId" : "i-0855e9c650df00b12",
          "instanceType" : "t2.micro",
          "kernelId" : null,
          "keyName" : "tara",
          "launchTime" : "2022-05-17T13:44:27Z",
          "monitoring" : {
            "state" : "disabled"
          },
          "placement" : {
            "availabilityZone" : "us-east-1a",
            "affinity" : null,
            "groupName" : "",
            "partitionNumber" : null,
            "hostId" : null,
            "tenancy" : "default",
            "spreadDomain" : null,
            "hostResourceGroupArn" : null
          },
          "platform" : null,
          "privateDnsName" : "ip-172-31-26-64.ec2.internal",
          "privateIpAddress" : "172.31.26.64",
          "productCodes" : [ ],
          "publicDnsName" : "",
          "publicIpAddress" : null,
          "ramdiskId" : null,
          "state" : {
            "code" : 16,
            "name" : "running"
          },
          "stateTransitionReason" : "",
          "subnetId" : "subnet-5be56c16",
          "vpcId" : "vpc-00e2e87a",
          "architecture" : "x86_64",
          "blockDeviceMappings" : [ {
            "deviceName" : "/dev/xvda",
            "ebs" : {
              "attachTime" : "2022-05-17T13:44:27Z",
              "deleteOnTermination" : true,
              "status" : "attached",
              "volumeId" : "vol-09f976aeb594f3319"
            }
          } ],
          "clientToken" : "",
          "ebsOptimized" : false,
          "enaSupport" : true,
          "hypervisor" : "xen",
          "iamInstanceProfile" : null,
          "instanceLifecycle" : null,
          "elasticGpuAssociations" : null,
          "elasticInferenceAcceleratorAssociations" : null,
          "networkInterfaces" : [ {
            "association" : null,
            "attachment" : {
              "attachTime" : "2022-05-17T13:44:27Z",
              "attachmentId" : "eni-attach-079904a417bab978c",
              "deleteOnTermination" : true,
              "deviceIndex" : 0,
              "status" : "attached",
              "networkCardIndex" : 0
            },
            "description" : "",
            "groups" : [ {
              "groupName" : "launch-wizard-1",
              "groupId" : "sg-0a8693adf81ee3db0"
            } ],
            "ipv6Addresses" : [ ],
            "macAddress" : "0a:d4:eb:fb:17:df",
            "networkInterfaceId" : "eni-07c6cc6dfc72f9878",
            "ownerId" : "00000000000",
            "privateDnsName" : "ip-172-31-26-64.ec2.internal",
            "privateIpAddress" : "172.31.26.64",
            "privateIpAddresses" : [ {
              "association" : null,
              "primary" : true,
              "privateDnsName" : "ip-172-31-26-64.ec2.internal",
              "privateIpAddress" : "172.31.26.64"
            } ],
            "sourceDestCheck" : true,
            "status" : "in-use",
            "subnetId" : "subnet-5be56c16",
            "vpcId" : "vpc-00e2e87a",
            "interfaceType" : "interface",
            "ipv4Prefixes" : null,
            "ipv6Prefixes" : null
          } ],
          "outpostArn" : null,
          "rootDeviceName" : "/dev/xvda",
          "rootDeviceType" : "ebs",
          "securityGroups" : [ {
            "groupName" : "launch-wizard-1",
            "groupId" : "sg-0a8693adf81ee3db0"
          } ],
          "sourceDestCheck" : true,
          "spotInstanceRequestId" : null,
          "sriovNetSupport" : null,
          "stateReason" : null,
          "tags" : [ {
            "key" : "Name",
            "value" : "test2nopublic"
          } ],
          "virtualizationType" : "hvm",
          "cpuOptions" : {
            "coreCount" : 1,
            "threadsPerCore" : 1
          },
          "capacityReservationId" : null,
          "capacityReservationSpecification" : {
            "capacityReservationPreference" : "open",
            "capacityReservationTarget" : null
          },
          "hibernationOptions" : {
            "configured" : false
          },
          "licenses" : null,
          "metadataOptions" : {
            "state" : "applied",
            "httpTokens" : "optional",
            "httpPutResponseHopLimit" : 1,
            "httpEndpoint" : "enabled",
            "httpProtocolIpv6" : "disabled"
          },
          "enclaveOptions" : {
            "enabled" : false
          },
          "bootMode" : null,
          "platformDetails" : "Linux/UNIX",
          "usageOperation" : "RunInstances",
          "usageOperationUpdateTime" : "2022-05-17T13:44:27Z",
          "privateDnsNameOptions" : {
            "hostnameType" : "ip-name",
            "enableResourceNameDnsARecord" : true,
            "enableResourceNameDnsAAAARecord" : false
          },
          "ipv6Address" : null
        },
        "supplementaryConfiguration" : {
          "awsBackupJobs" : [ ]
        },
        "tags" : {
          "Name" : "test2nopublic"
        },
        "discoveryMeta" : { }
      }]
