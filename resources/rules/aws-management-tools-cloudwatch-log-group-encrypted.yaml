ruleId: aws-management-tools-cloudwatch-log-group-encrypted
type: asset
ruleName: >
  Checks if a CloudWatch log group is encrypted with a KMS key
description: >
  Checks if a log group in Amazon CloudWatch Logs is encrypted with a AWS Key Management Service (KMS) managed Customer Master Keys (CMK). The rule is NON_COMPLIANT if no AWS KMS CMK is configured on the log groups.
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awswatchloggroup
  WHERE (configuration -> 'kmsKeyId' = 'null')
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
