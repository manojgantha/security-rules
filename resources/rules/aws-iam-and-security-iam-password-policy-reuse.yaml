id: 463947f9-fafa-4fa1-88a5-dab855928bca
refId: aws-iam-and-security-iam-password-policy-reuse
type: asset
name: >
  IAM password policy does not prevent password reuse
description: >
  Identifies IAM password policies which allow password reuse.
severity: high
enabled: true
sql: >
  SELECT arn as assetid
  FROM ${magpie_schema}.awsaccount
    WHERE (supplementaryconfiguration->'passwordPolicy' = 'null'
         OR supplementaryconfiguration->'passwordPolicy'->'passwordReusePrevention' != '24');
remediation: >
  Amend password policy to prevent password re-use.
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 1.0.6
