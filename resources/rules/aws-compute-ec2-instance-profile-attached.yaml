ruleId: aws-compute-ec2-instance-profile-attached
type: asset
ruleName: >
  Checks if an Amazon Elastic Compute Cloud (Amazon EC2) instance has an Identity and Access Management (IAM) profile attached to it.
description: >
  Checks if an Amazon Elastic Compute Cloud (Amazon EC2) instance has an Identity and Access Management (IAM) profile attached to it. This rule is NON_COMPLIANT if no IAM profile is attached to the Amazon EC2 instance.
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awsec2instance
  WHERE configuration->'iamInstanceProfile' = 'null';
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
