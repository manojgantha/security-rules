id: 617dcff9-15b2-4a8e-969d-c36ed0226922
refId: aws-compute-eks-secrets-encrypted
type: asset
name: >
  EKS cluster does not have secrets encrypted using KMS keys
description: >
  Identifies EKS clusters which do not have secrets encrypted using KMS keys.
severity: medium
enabled: true
sql: >
  SELECT arn as assetid
  FROM ${magpie_schema}.awsekscluster
  WHERE (configuration -> 'cluster' -> 'encryptionConfig' = 'null');
remediation: >
  Enable KMS encryption for EKS cluster secrets that are currently not encrypted.
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 1.0.6
