id: 3f2a6c76-edd8-4e6f-b0e1-5213acbfebda
# opnrvn-r-60
refId: aws-management-tools-cloudtrail-cloudwatch-logs-enabled
type: asset
name: >
  CloudTrail trail is not integrated with CloudWatch logs
description: >
  Identifies CloudTrail trails that are not integrated with CloudWatch logs.
severity: low
enabled: true
sql: >
  SELECT arn as assetid
  FROM ${magpie_schema}.awscloudtrailtrail
  WHERE (supplementaryconfiguration->'trailDetails'->'trail'->'cloudWatchLogsLogGroupArn' = 'null'
  OR supplementaryconfiguration->'status'->'latestCloudWatchLogsDeliveryTime' = 'null'
  OR TO_TIMESTAMP(supplementaryconfiguration->'status'->>'latestCloudWatchLogsDeliveryTime', 'YYYY-MM-DD"T"HH24:MI:SS') < now() - interval '1 day');
remediation: >
  Integrate CloudTrail trails with CloudWatch logs.
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 1.0.6
