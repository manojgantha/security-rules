id: 66d58541-3a0d-44f2-9d06-01a5bd6a67b6
refId: aws-compute-ec2-instances-in-vpc
type: asset
name: >
  EC2 instance does not belong to a VPC
description: >
  This rule identifies EC2 instances which do not belong to a VPC. If the VPC ID parameter has no value assigned, the selected EC2 instance was launched within the EC2-Classic platform and should be moved to the EC2-VPC platform.
severity: low
enabled: true
sql: >
  SELECT arn as assetid
  FROM ${magpie_schema}.awsec2instance
  WHERE configuration->>'vpcId' IS NULL;
remediation: >
  Ensure that EC2 instances belong to the appropriate VPC.
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 1.0.7
