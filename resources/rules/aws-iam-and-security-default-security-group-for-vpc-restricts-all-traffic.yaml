id: 55b62465-1bdb-4388-9adf-b88d5e83812b
#opnrvn-r-7
refId: aws-iam-and-security-default-security-group-for-vpc-restricts-all-traffic
type: asset
name: >
  Default security group of every VPC does not restrict all traffic
description: >
  Identifies a default security group that is used for every VPC which does not restrict all incoming traffic.
severity: medium
enabled: true
sql: >
  SELECT arn as assetid
  FROM ${magpie_schema}.awsec2securitygroup
    WHERE resourcename = 'default'
    AND (jsonb_array_length(configuration->'ipPermissions') > 0
         OR jsonb_array_length(configuration->'ipPermissionsEgress') > 0);
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 1.0.5
