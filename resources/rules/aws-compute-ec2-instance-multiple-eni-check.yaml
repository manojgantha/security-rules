ruleId: aws-compute-ec2-instance-multiple-eni-check
type: asset
ruleName: >
  Checks if Amazon Elastic Compute Cloud (Amazon EC2) uses multiple ENIs (Elastic Network Interfaces).
description: >
  Checks if Amazon Elastic Compute Cloud (Amazon EC2) uses multiple ENIs (Elastic Network Interfaces). This rule is NON_COMPLIANT an Amazon EC2 instance use multiple network interfaces.
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awsec2instance
  WHERE EXISTS (SELECT * FROM jsonb_array_elements(configuration->'networkInterfaces') eni
  WHERE eni ->'networkInterfaceId' = 'null');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
