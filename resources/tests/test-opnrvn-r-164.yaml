ruleId: opnrvn-r-164
description: >
      - Checks if Amazon DynamoDB tables are protected by a backup plan.
      - `no-aws-backup` Insecure Assets have no aws-backup
      - `aws-backup` Secure Assets have aws-backup
insecureAssets:
  no-aws-backup: >
    [ {
        "documentId" : "ay6C53_LP4au4s6aXXZeIg",
        "arn" : "no-aws-backup",
        "resourceName" : "no-aws-backup",
        "resourceId" : "no-aws-backup",
        "resourceType" : "AWS::DynamoDB::Table",
        "awsRegion" : "us-east-1",
        "awsAccountId" : "476384142167",
        "createdIso" : "2021-12-14T12:17:50.065Z",
        "updatedIso" : "2021-12-14T14:49:18.992172Z",
        "discoverySessionId" : null,
        "maxSizeInBytes" : null,
        "sizeInBytes" : null,
        "configuration" : {
          "attributeDefinitions" : [ {
            "attributeName" : "sdfg",
            "attributeType" : "S"
          }, {
            "attributeName" : "sdfgx",
            "attributeType" : "S"
          } ],
          "tableName" : "no-aws-backup",
          "keySchema" : [ {
            "attributeName" : "sdfg",
            "keyType" : "HASH"
          }, {
            "attributeName" : "sdfgx",
            "keyType" : "RANGE"
          } ],
          "tableStatus" : "ACTIVE",
          "creationDateTime" : "2021-12-14T12:17:50.065Z",
          "provisionedThroughput" : {
            "lastIncreaseDateTime" : null,
            "lastDecreaseDateTime" : null,
            "numberOfDecreasesToday" : 0,
            "readCapacityUnits" : 0,
            "writeCapacityUnits" : 0
          },
          "tableSizeBytes" : 0,
          "itemCount" : 0,
          "tableArn" : "no-aws-backup",
          "tableId" : "no-aws-backup",
          "billingModeSummary" : null,
          "sseDescription" : null,
          "localSecondaryIndexes" : null,
          "globalSecondaryIndexes" : null,
          "streamSpecification" : null,
          "latestStreamLabel" : null,
          "latestStreamArn" : null,
          "globalTableVersion" : null,
          "replicas" : null,
          "restoreSummary" : null,
          "archivalSummary" : null
        },
        "supplementaryConfiguration" : {
          "continuousBackups" : {
            "continuousBackupsDescription" : {
              "continuousBackupsStatus" : "ENABLED",
              "pointInTimeRecoveryDescription" : {
                "pointInTimeRecoveryStatus" : "DISABLED",
                "earliestRestorableDateTime" : "2021-12-14T14:24:46Z",
                "latestRestorableDateTime" : "2021-12-14T14:44:21.219Z"
              }
            }
          },
          "tags" : { },
          "awsBackupJobs" : [ ]
        },
        "tags" : { },
        "discoveryMeta" : { }
    }]
secureAssets:
  aws-backup: >
    [ {
        "documentId" : "ay6C53_LP4au4s6aXXZeIg",
        "arn" : "aws-backup",
        "resourceName" : "aws-backup",
        "resourceId" : "aws-backup",
        "resourceType" : "AWS::DynamoDB::Table",
        "awsRegion" : "us-east-1",
        "awsAccountId" : "476384142167",
        "createdIso" : "2021-12-14T12:17:50.065Z",
        "updatedIso" : "2021-12-14T14:49:18.992172Z",
        "discoverySessionId" : null,
        "maxSizeInBytes" : null,
        "sizeInBytes" : null,
        "configuration" : {
          "attributeDefinitions" : [ {
            "attributeName" : "sdfg",
            "attributeType" : "S"
          }, {
            "attributeName" : "sdfgx",
            "attributeType" : "S"
          } ],
          "tableName" : "testing123",
          "keySchema" : [ {
            "attributeName" : "sdfg",
            "keyType" : "HASH"
          }, {
            "attributeName" : "sdfgx",
            "keyType" : "RANGE"
          } ],
          "tableStatus" : "ACTIVE",
          "creationDateTime" : "2021-12-14T12:17:50.065Z",
          "provisionedThroughput" : {
            "lastIncreaseDateTime" : null,
            "lastDecreaseDateTime" : null,
            "numberOfDecreasesToday" : 0,
            "readCapacityUnits" : 0,
            "writeCapacityUnits" : 0
          },
          "tableSizeBytes" : 0,
          "itemCount" : 0,
          "tableArn" : "arn:aws:dynamodb:us-east-1:476384142167:table/testing123",
          "tableId" : "0ef1391d-d2a7-4b7a-80c0-f3509534ddf0",
          "billingModeSummary" : {
            "billingMode" : "PAY_PER_REQUEST",
            "lastUpdateToPayPerRequestDateTime" : "2021-12-14T12:17:50.065Z"
          },
          "localSecondaryIndexes" : null,
          "globalSecondaryIndexes" : null,
          "streamSpecification" : null,
          "latestStreamLabel" : null,
          "latestStreamArn" : null,
          "globalTableVersion" : null,
          "replicas" : null,
          "restoreSummary" : null,
          "sseDescription" : {
            "status" : "ENABLED",
            "sseType" : "KMS",
            "kmsMasterKeyArn" : "arn:aws:kms:us-east-1:476384142167:key/0dd09529-bacc-42a4-b579-e91d96ce21f2",
            "inaccessibleEncryptionDateTime" : null
          },
          "archivalSummary" : null
        },
        "supplementaryConfiguration" : {
          "continuousBackups" : {
            "continuousBackupsDescription" : {
              "continuousBackupsStatus" : "ENABLED",
              "pointInTimeRecoveryDescription" : {
                "pointInTimeRecoveryStatus" : "ENABLED",
                "earliestRestorableDateTime" : "2021-12-14T14:24:46Z",
                "latestRestorableDateTime" : "2021-12-14T14:44:21.219Z"
              }
            }
          },
          "tags" : { },
          "awsBackupJobs" : [ {
                "accountId" : "476384142167",
                "backupJobId" : "5364B1D4-36AD-33AF-CF2F-7359AAA326E7",
                "backupVaultName" : "Default",
                "backupVaultArn" : "arn:aws:backup:us-east-1:476384142167:backup-vault:Default",
                "recoveryPointArn" : "arn:aws:backup:us-east-1:476384142167:recovery-point:69203525-0b5e-4dbd-b2a2-be5ddadcd77e",
                "resourceArn" : "arn:aws:dynamodb:us-east-1:476384142167:table/sdfvbg",
                "creationDate" : "2021-12-14T14:43:54.710Z",
                "completionDate" : "2021-12-14T14:47:12.069Z",
                "state" : "COMPLETED",
                "statusMessage" : null,
                "percentDone" : "100.0",
                "backupSizeInBytes" : 0,
                "iamRoleArn" : "arn:aws:iam::476384142167:role/service-role/AWSBackupDefaultServiceRole",
                "createdBy" : null,
                "expectedCompletionDate" : null,
                "startBy" : "2021-12-14T15:43:54.710Z",
                "resourceType" : "DynamoDB",
                "bytesTransferred" : null,
                "backupOptions" : null,
                "backupType" : null
              } ]
        },
        "tags" : { },
        "discoveryMeta" : { }
    }]
