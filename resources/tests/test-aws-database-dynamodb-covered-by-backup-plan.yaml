ruleId: aws-database-dynamodb-covered-by-backup-plan
cloudProvider: aws
description: >
  Insecure assets have no backup plan.
  Secure assets have a backup plan.
insecureAssets:
  No backup plans configured for all DynamoDB instances.: >
    [{
       "documentId" : "dBY7DFMUMvyT8FVM9qEEEA",
       "arn" : "no-backup-plan-enabled",
       "resourceName" : "dyanmodbtest",
       "resourceId" : "dyanmodbtest",
       "resourceType" : "AWS::Backup::BackupPlan",
       "awsRegion" : "us-east-2",
       "awsAccountId" : "476384142167",
       "createdIso" : "2022-02-03T15:24:14.570Z",
       "updatedIso" : "2022-02-18T16:02:20.085285Z",
       "discoverySessionId" : null,
       "maxSizeInBytes" : null,
       "sizeInBytes" : null,
       "configuration" : {
         "backupPlanArn" : "no-backup-plan-enable",
         "backupPlanId" : "30cee365-fbfa-48b5-94ad-7080202639d4",
         "creationDate" : "2022-02-03T15:24:14.570Z",
         "deletionDate" : null,
         "versionId" : "MzRmZGJjZWItZmMwZC00Yjc3LWI3MzQtMDhiNGRmNTE1YWIz",
         "backupPlanName" : "dyanmodbtest",
         "creatorRequestId" : null,
         "lastExecutionDate" : "2022-02-18T05:48:34.457Z",
         "advancedBackupSettings" : null
       },
       "supplementaryConfiguration" : {
         "backupSelections" : [ {
           "backupSelection" : {
             "selectionName" : "dyanmodbtestbackup",
             "iamRoleArn" : "arn:aws:iam::476384142167:role/service-role/AWSBackupDefaultServiceRole",
             "resources" : [ "arn:aws:dyanmodb:us-east-2:476384142167:db:database-tara-test-enabled" ],
             "listOfTags" : [ ],
             "notResources" : [ ],
             "conditions" : {
               "stringEquals" : [ ],
               "stringNotEquals" : [ ],
               "stringLike" : [ ],
               "stringNotLike" : [ ]
             }
           },
           "selectionId" : "48d91c71-57d1-4508-8252-7f9a1aa21eab",
           "backupPlanId" : "30cee365-fbfa-48b5-94ad-7080202639d4",
           "creationDate" : "2022-02-03T15:25:41.702Z",
           "creatorRequestId" : "055e7c0c-284e-4c4e-8b5c-ee4294a475d9"
         }, {
           "backupSelection" : {
             "selectionName" : "dyanmodbaurora-test",
             "iamRoleArn" : "arn:aws:iam::476384142167:role/service-role/AWSBackupDefaultServiceRole",
             "resources" : [ "" ],
             "listOfTags" : [ ],
             "notResources" : [ ],
             "conditions" : {
               "stringEquals" : [ ],
               "stringNotEquals" : [ ],
               "stringLike" : [ ],
               "stringNotLike" : [ ]
             }
           },
           "selectionId" : "e6bb621f-b13e-444a-9aba-5b84428761d3",
           "backupPlanId" : "30cee365-fbfa-48b5-94ad-7080202639d4",
           "creationDate" : "2022-02-18T14:44:14.317Z",
           "creatorRequestId" : "8e649614-cd19-4e37-82d7-3318225cdc96"
         } ]
       },
       "tags" : { },
       "discoveryMeta" : { }
     }]
secureAssets:
  backup-plan-enabled: >
    [{
       "documentId" : "dBY7DFMUMvyT8FVM9qEEEA",
       "arn" : "backup-plan-enabled",
       "resourceName" : "dyanmodbtest",
       "resourceId" : "dyanmodbtest",
       "resourceType" : "AWS::Backup::BackupPlan",
       "awsRegion" : "us-east-2",
       "awsAccountId" : "476384142167",
       "createdIso" : "2022-02-03T15:24:14.570Z",
       "updatedIso" : "2022-02-18T16:02:20.085285Z",
       "discoverySessionId" : null,
       "maxSizeInBytes" : null,
       "sizeInBytes" : null,
       "configuration" : {
         "backupPlanArn" : "backup-plan-enable",
         "backupPlanId" : "30cee365-fbfa-48b5-94ad-7080202639d4",
         "creationDate" : "2022-02-03T15:24:14.570Z",
         "deletionDate" : null,
         "versionId" : "MzRmZGJjZWItZmMwZC00Yjc3LWI3MzQtMDhiNGRmNTE1YWIz",
         "backupPlanName" : "dyanmodbtest",
         "creatorRequestId" : null,
         "lastExecutionDate" : "2022-02-18T05:48:34.457Z",
         "advancedBackupSettings" : null
       },
       "supplementaryConfiguration" : {
         "backupSelections" : [ {
           "backupSelection" : {
             "selectionName" : "dyanmodbtestbackup",
             "iamRoleArn" : "arn:aws:iam::476384142167:role/service-role/AWSBackupDefaultServiceRole",
             "resources" : [ "arn:aws:dyanmodb:us-east-2:476384142167:db:database-tara-test-enabled" ],
             "listOfTags" : [ ],
             "notResources" : [ ],
             "conditions" : {
               "stringEquals" : [ ],
               "stringNotEquals" : [ ],
               "stringLike" : [ ],
               "stringNotLike" : [ ]
             }
           },
           "selectionId" : "48d91c71-57d1-4508-8252-7f9a1aa21eab",
           "backupPlanId" : "30cee365-fbfa-48b5-94ad-7080202639d4",
           "creationDate" : "2022-02-03T15:25:41.702Z",
           "creatorRequestId" : "055e7c0c-284e-4c4e-8b5c-ee4294a475d9"
         }, {
           "backupSelection" : {
             "selectionName" : "dyanmodbaurora-test",
             "iamRoleArn" : "arn:aws:iam::476384142167:role/service-role/AWSBackupDefaultServiceRole",
             "resources" : [ "arn:aws:dynamodb:*:*:table*" ],
             "listOfTags" : [ ],
             "notResources" : [ ],
             "conditions" : {
               "stringEquals" : [ ],
               "stringNotEquals" : [ ],
               "stringLike" : [ ],
               "stringNotLike" : [ ]
             }
           },
           "selectionId" : "e6bb621f-b13e-444a-9aba-5b84428761d3",
           "backupPlanId" : "30cee365-fbfa-48b5-94ad-7080202639d4",
           "creationDate" : "2022-02-18T14:44:14.317Z",
           "creatorRequestId" : "8e649614-cd19-4e37-82d7-3318225cdc96"
         } ]
       },
       "tags" : { },
       "discoveryMeta" : { }
     }]
