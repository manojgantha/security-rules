ruleId: aws-database-rds-instance-public-access-check
cloudProvider: aws
description: >
  Insecure assets have public access
  Secure assets have no public access
insecureAssets:
  arn:aws:rds:us-east-2:476384142167:db:database-public-instance-1: >
    [{
      "documentId" : "VlkRr5tiNL2d0LVZDLon8g",
      "arn" : "arn:aws:rds:us-east-2:476384142167:db:database-public-instance-1",
      "resourceName" : "database-public-instance-1",
      "resourceId" : "arn:aws:rds:us-east-2:476384142167:db:database-public-instance-1",
      "resourceType" : "AWS::RDS::DBInstance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : "2021-12-15T13:45:14.832Z",
      "updatedIso" : "2021-12-15T13:55:12.396111Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "dbInstanceIdentifier" : "database-public-instance-1",
        "dbInstanceClass" : "db.r5.large",
        "engine" : "aurora-mysql",
        "dbInstanceStatus" : "available",
        "automaticRestartTime" : null,
        "masterUsername" : "admin",
        "dbName" : null,
        "endpoint" : {
          "address" : "database-public-instance-1.cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
          "port" : 3306,
          "hostedZoneId" : "Z2XHWR1WZ565X2"
        },
        "allocatedStorage" : 1,
        "instanceCreateTime" : "2021-12-15T13:45:14.832Z",
        "preferredBackupWindow" : "03:57-04:27",
        "backupRetentionPeriod" : 1,
        "dbSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "dbParameterGroups" : [ {
          "dbParameterGroupName" : "default.aurora-mysql5.7",
          "parameterApplyStatus" : "in-sync"
        } ],
        "availabilityZone" : "us-east-2a",
        "dbSubnetGroup" : {
          "dbSubnetGroupName" : "default-vpc-6487540f",
          "dbSubnetGroupDescription" : "Created from the RDS Management Console",
          "vpcId" : "vpc-6487540f",
          "subnetGroupStatus" : "Complete",
          "subnets" : [ {
            "subnetIdentifier" : "subnet-249c674f",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2a"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-970130ed",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2b"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-7a198036",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2c"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          } ],
          "dbSubnetGroupArn" : null
        },
        "preferredMaintenanceWindow" : "sun:08:20-sun:08:50",
        "pendingModifiedValues" : {
          "dbInstanceClass" : null,
          "allocatedStorage" : null,
          "masterUserPassword" : null,
          "port" : null,
          "backupRetentionPeriod" : null,
          "multiAZ" : null,
          "engineVersion" : null,
          "licenseModel" : null,
          "iops" : null,
          "dbInstanceIdentifier" : null,
          "storageType" : null,
          "caCertificateIdentifier" : null,
          "dbSubnetGroupName" : null,
          "pendingCloudwatchLogsExports" : null,
          "processorFeatures" : null,
          "iamDatabaseAuthenticationEnabled" : null,
          "automationMode" : null,
          "resumeFullAutomationModeTime" : null
        },
        "latestRestorableTime" : null,
        "multiAZ" : false,
        "engineVersion" : "5.7.mysql_aurora.2.07.2",
        "autoMinorVersionUpgrade" : true,
        "readReplicaSourceDBInstanceIdentifier" : null,
        "readReplicaDBInstanceIdentifiers" : [ ],
        "readReplicaDBClusterIdentifiers" : null,
        "replicaMode" : null,
        "licenseModel" : "general-public-license",
        "iops" : null,
        "optionGroupMemberships" : [ {
          "optionGroupName" : "default:aurora-mysql-5-7",
          "status" : "in-sync"
        } ],
        "characterSetName" : null,
        "ncharCharacterSetName" : null,
        "secondaryAvailabilityZone" : null,
        "publiclyAccessible" : true,
        "statusInfos" : null,
        "storageType" : "aurora",
        "tdeCredentialArn" : null,
        "dbInstancePort" : 0,
        "dbClusterIdentifier" : "database-public",
        "storageEncrypted" : true,
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "dbiResourceId" : "db-MBY2TVHKKJEGCHTIRV7AKH5HFQ",
        "caCertificateIdentifier" : "rds-ca-2019",
        "domainMemberships" : [ ],
        "copyTagsToSnapshot" : false,
        "monitoringInterval" : 60,
        "enhancedMonitoringResourceArn" : "arn:aws:logs:us-east-2:476384142167:log-group:RDSOSMetrics:log-stream:db-MBY2TVHKKJEGCHTIRV7AKH5HFQ",
        "monitoringRoleArn" : "arn:aws:iam::476384142167:role/rds-monitoring-role",
        "promotionTier" : 1,
        "dbInstanceArn" : "arn:aws:rds:us-east-2:476384142167:db:database-public-instance-1",
        "timezone" : null,
        "iamDatabaseAuthenticationEnabled" : false,
        "performanceInsightsEnabled" : true,
        "performanceInsightsKMSKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "performanceInsightsRetentionPeriod" : 7,
        "enabledCloudwatchLogsExports" : null,
        "processorFeatures" : null,
        "deletionProtection" : false,
        "associatedRoles" : [ ],
        "listenerEndpoint" : null,
        "maxAllocatedStorage" : null,
        "tagList" : [ ],
        "dbInstanceAutomatedBackupsReplications" : null,
        "customerOwnedIpEnabled" : false,
        "awsBackupRecoveryPointArn" : null,
        "activityStreamStatus" : null,
        "activityStreamKmsKeyId" : null,
        "activityStreamKinesisStreamName" : null,
        "activityStreamMode" : null,
        "activityStreamEngineNativeAuditFieldsIncluded" : null,
        "automationMode" : null,
        "resumeFullAutomationModeTime" : null,
        "customIamInstanceProfile" : null,
        "backupTarget" : "region"
      },
      "supplementaryConfiguration" : {
        "dbClusters" : {
          "marker" : null,
          "dbClusters" : [ {
            "allocatedStorage" : 1,
            "availabilityZones" : [ "us-east-2b", "us-east-2c", "us-east-2a" ],
            "backupRetentionPeriod" : 1,
            "characterSetName" : null,
            "databaseName" : "",
            "dbClusterIdentifier" : "database-public",
            "dbClusterParameterGroup" : "default.aurora-mysql5.7",
            "dbSubnetGroup" : "default-vpc-6487540f",
            "status" : "available",
            "automaticRestartTime" : null,
            "percentProgress" : null,
            "earliestRestorableTime" : "2021-12-15T13:40:29.922Z",
            "endpoint" : "database-public.cluster-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "readerEndpoint" : "database-public.cluster-ro-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "customEndpoints" : null,
            "multiAZ" : false,
            "engine" : "aurora-mysql",
            "engineVersion" : "5.7.mysql_aurora.2.07.2",
            "latestRestorableTime" : "2021-12-15T13:54:21.416Z",
            "port" : 3306,
            "masterUsername" : "admin",
            "dbClusterOptionGroupMemberships" : null,
            "preferredBackupWindow" : "03:57-04:27",
            "preferredMaintenanceWindow" : "tue:06:12-tue:06:42",
            "replicationSourceIdentifier" : null,
            "readReplicaIdentifiers" : [ ],
            "dbClusterMembers" : [ {
              "dbInstanceIdentifier" : "database-public-instance-1",
              "isClusterWriter" : true,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            } ],
            "vpcSecurityGroups" : [ {
              "vpcSecurityGroupId" : "sg-3afa2c42",
              "status" : "active"
            } ],
            "hostedZoneId" : "Z2XHWR1WZ565X2",
            "storageEncrypted" : true,
            "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
            "dbClusterResourceId" : "cluster-NNDZR37SDOWYO22MC6YYHBAA5Q",
            "dbClusterArn" : "arn:aws:rds:us-east-2:476384142167:cluster:database-public",
            "associatedRoles" : [ ],
            "iamDatabaseAuthenticationEnabled" : false,
            "cloneGroupId" : null,
            "clusterCreateTime" : "2021-12-15T13:39:45.540Z",
            "earliestBacktrackTime" : null,
            "backtrackWindow" : null,
            "backtrackConsumedChangeRecords" : null,
            "enabledCloudwatchLogsExports" : null,
            "capacity" : null,
            "engineMode" : "provisioned",
            "scalingConfigurationInfo" : null,
            "deletionProtection" : true,
            "httpEndpointEnabled" : false,
            "activityStreamMode" : null,
            "activityStreamStatus" : "stopped",
            "activityStreamKmsKeyId" : null,
            "activityStreamKinesisStreamName" : null,
            "copyTagsToSnapshot" : true,
            "crossAccountClone" : false,
            "domainMemberships" : [ ],
            "tagList" : [ ],
            "globalWriteForwardingStatus" : null,
            "globalWriteForwardingRequested" : null,
            "pendingModifiedValues" : null,
            "dbClusterInstanceClass" : null,
            "storageType" : null,
            "iops" : null,
            "publiclyAccessible" : null,
            "autoMinorVersionUpgrade" : false,
            "monitoringInterval" : null,
            "monitoringRoleArn" : null,
            "performanceInsightsEnabled" : null,
            "performanceInsightsKMSKeyId" : null,
            "performanceInsightsRetentionPeriod" : null
          } ]
        },
        "dbSnapshot" : {
          "marker" : null,
          "dbSnapshots" : [ ]
        },
        "awsBackupJobs" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
secureAssets:
  arn:aws:rds:us-east-2:476384142167:db:database-not-public-instance-1: >
    [{
      "documentId" : "gXUNZiEZNbKo6Ll1XFtksw",
      "arn" : "arn:aws:rds:us-east-2:476384142167:db:database-not-public-instance-1",
      "resourceName" : "database-not-public-instance-1",
      "resourceId" : "arn:aws:rds:us-east-2:476384142167:db:database-not-public-instance-1",
      "resourceType" : "AWS::RDS::DBInstance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : "2021-12-15T13:45:45.032Z",
      "updatedIso" : "2021-12-15T13:55:09.137854Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "dbInstanceIdentifier" : "database-not-public-instance-1",
        "dbInstanceClass" : "db.r5.large",
        "engine" : "aurora-mysql",
        "dbInstanceStatus" : "available",
        "automaticRestartTime" : null,
        "masterUsername" : "admin",
        "dbName" : null,
        "endpoint" : {
          "address" : "database-not-public-instance-1.cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
          "port" : 3306,
          "hostedZoneId" : "Z2XHWR1WZ565X2"
        },
        "allocatedStorage" : 1,
        "instanceCreateTime" : "2021-12-15T13:45:45.032Z",
        "preferredBackupWindow" : "06:24-06:54",
        "backupRetentionPeriod" : 1,
        "dbSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "dbParameterGroups" : [ {
          "dbParameterGroupName" : "default.aurora-mysql5.7",
          "parameterApplyStatus" : "in-sync"
        } ],
        "availabilityZone" : "us-east-2b",
        "dbSubnetGroup" : {
          "dbSubnetGroupName" : "default-vpc-6487540f",
          "dbSubnetGroupDescription" : "Created from the RDS Management Console",
          "vpcId" : "vpc-6487540f",
          "subnetGroupStatus" : "Complete",
          "subnets" : [ {
            "subnetIdentifier" : "subnet-249c674f",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2a"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-970130ed",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2b"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-7a198036",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2c"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          } ],
          "dbSubnetGroupArn" : null
        },
        "preferredMaintenanceWindow" : "fri:05:43-fri:06:13",
        "pendingModifiedValues" : {
          "dbInstanceClass" : null,
          "allocatedStorage" : null,
          "masterUserPassword" : null,
          "port" : null,
          "backupRetentionPeriod" : null,
          "multiAZ" : null,
          "engineVersion" : null,
          "licenseModel" : null,
          "iops" : null,
          "dbInstanceIdentifier" : null,
          "storageType" : null,
          "caCertificateIdentifier" : null,
          "dbSubnetGroupName" : null,
          "pendingCloudwatchLogsExports" : null,
          "processorFeatures" : null,
          "iamDatabaseAuthenticationEnabled" : null,
          "automationMode" : null,
          "resumeFullAutomationModeTime" : null
        },
        "latestRestorableTime" : null,
        "multiAZ" : false,
        "engineVersion" : "5.7.mysql_aurora.2.07.2",
        "autoMinorVersionUpgrade" : true,
        "readReplicaSourceDBInstanceIdentifier" : null,
        "readReplicaDBInstanceIdentifiers" : [ ],
        "readReplicaDBClusterIdentifiers" : null,
        "replicaMode" : null,
        "licenseModel" : "general-public-license",
        "iops" : null,
        "optionGroupMemberships" : [ {
          "optionGroupName" : "default:aurora-mysql-5-7",
          "status" : "in-sync"
        } ],
        "characterSetName" : null,
        "ncharCharacterSetName" : null,
        "secondaryAvailabilityZone" : null,
        "publiclyAccessible" : false,
        "statusInfos" : null,
        "storageType" : "aurora",
        "tdeCredentialArn" : null,
        "dbInstancePort" : 0,
        "dbClusterIdentifier" : "database-not-public",
        "storageEncrypted" : true,
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "dbiResourceId" : "db-JTPBGPXE7B2ZOJECBQ3UQDI7AY",
        "caCertificateIdentifier" : "rds-ca-2019",
        "domainMemberships" : [ ],
        "copyTagsToSnapshot" : false,
        "monitoringInterval" : 60,
        "enhancedMonitoringResourceArn" : "arn:aws:logs:us-east-2:476384142167:log-group:RDSOSMetrics:log-stream:db-JTPBGPXE7B2ZOJECBQ3UQDI7AY",
        "monitoringRoleArn" : "arn:aws:iam::476384142167:role/rds-monitoring-role",
        "promotionTier" : 1,
        "dbInstanceArn" : "arn:aws:rds:us-east-2:476384142167:db:database-not-public-instance-1",
        "timezone" : null,
        "iamDatabaseAuthenticationEnabled" : false,
        "performanceInsightsEnabled" : true,
        "performanceInsightsKMSKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "performanceInsightsRetentionPeriod" : 7,
        "enabledCloudwatchLogsExports" : null,
        "processorFeatures" : null,
        "deletionProtection" : false,
        "associatedRoles" : [ ],
        "listenerEndpoint" : null,
        "maxAllocatedStorage" : null,
        "tagList" : [ ],
        "dbInstanceAutomatedBackupsReplications" : null,
        "customerOwnedIpEnabled" : false,
        "awsBackupRecoveryPointArn" : null,
        "activityStreamStatus" : null,
        "activityStreamKmsKeyId" : null,
        "activityStreamKinesisStreamName" : null,
        "activityStreamMode" : null,
        "activityStreamEngineNativeAuditFieldsIncluded" : null,
        "automationMode" : null,
        "resumeFullAutomationModeTime" : null,
        "customIamInstanceProfile" : null,
        "backupTarget" : "region"
      },
      "supplementaryConfiguration" : {
        "dbClusters" : {
          "marker" : null,
          "dbClusters" : [ {
            "allocatedStorage" : 1,
            "availabilityZones" : [ "us-east-2b", "us-east-2c", "us-east-2a" ],
            "backupRetentionPeriod" : 1,
            "characterSetName" : null,
            "databaseName" : "",
            "dbClusterIdentifier" : "database-not-public",
            "dbClusterParameterGroup" : "default.aurora-mysql5.7",
            "dbSubnetGroup" : "default-vpc-6487540f",
            "status" : "available",
            "automaticRestartTime" : null,
            "percentProgress" : null,
            "earliestRestorableTime" : "2021-12-15T13:41:10.564Z",
            "endpoint" : "database-not-public.cluster-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "readerEndpoint" : "database-not-public.cluster-ro-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "customEndpoints" : null,
            "multiAZ" : true,
            "engine" : "aurora-mysql",
            "engineVersion" : "5.7.mysql_aurora.2.07.2",
            "latestRestorableTime" : "2021-12-15T13:52:47.452Z",
            "port" : 3306,
            "masterUsername" : "admin",
            "dbClusterOptionGroupMemberships" : null,
            "preferredBackupWindow" : "06:24-06:54",
            "preferredMaintenanceWindow" : "sat:07:38-sat:08:08",
            "replicationSourceIdentifier" : null,
            "readReplicaIdentifiers" : [ ],
            "dbClusterMembers" : [ {
              "dbInstanceIdentifier" : "database-not-public-instance-1-us-east-2c",
              "isClusterWriter" : false,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            }, {
              "dbInstanceIdentifier" : "database-not-public-instance-1",
              "isClusterWriter" : true,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            } ],
            "vpcSecurityGroups" : [ {
              "vpcSecurityGroupId" : "sg-3afa2c42",
              "status" : "active"
            } ],
            "hostedZoneId" : "Z2XHWR1WZ565X2",
            "storageEncrypted" : true,
            "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
            "dbClusterResourceId" : "cluster-W2VQU6NEZOLXIYE5JI3CYJTKMM",
            "dbClusterArn" : "arn:aws:rds:us-east-2:476384142167:cluster:database-not-public",
            "associatedRoles" : [ ],
            "iamDatabaseAuthenticationEnabled" : false,
            "cloneGroupId" : null,
            "clusterCreateTime" : "2021-12-15T13:40:16.954Z",
            "earliestBacktrackTime" : null,
            "backtrackWindow" : null,
            "backtrackConsumedChangeRecords" : null,
            "enabledCloudwatchLogsExports" : null,
            "capacity" : null,
            "engineMode" : "provisioned",
            "scalingConfigurationInfo" : null,
            "deletionProtection" : true,
            "httpEndpointEnabled" : false,
            "activityStreamMode" : null,
            "activityStreamStatus" : "stopped",
            "activityStreamKmsKeyId" : null,
            "activityStreamKinesisStreamName" : null,
            "copyTagsToSnapshot" : true,
            "crossAccountClone" : false,
            "domainMemberships" : [ ],
            "tagList" : [ ],
            "globalWriteForwardingStatus" : null,
            "globalWriteForwardingRequested" : null,
            "pendingModifiedValues" : null,
            "dbClusterInstanceClass" : null,
            "storageType" : null,
            "iops" : null,
            "publiclyAccessible" : null,
            "autoMinorVersionUpgrade" : false,
            "monitoringInterval" : null,
            "monitoringRoleArn" : null,
            "performanceInsightsEnabled" : null,
            "performanceInsightsKMSKeyId" : null,
            "performanceInsightsRetentionPeriod" : null
          } ]
        },
        "dbSnapshot" : {
          "marker" : null,
          "dbSnapshots" : [ ]
        },
        "awsBackupJobs" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
