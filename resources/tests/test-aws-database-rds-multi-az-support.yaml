# opnrvn-r-155
ruleId: aws-database-rds-multi-az-support
description: >
  - `no-multiaz` Insecure Assets have no multiAZ
  - `multiaz` Secure Assets have multiAZ
insecureAssets:
  no-multiaz: >
    [ {
      "documentId" : "EzO38uQXN5yccducRTeoPw",
      "arn" : "no-multiaz",
      "resourceName" : "no-multiaz",
      "resourceId" : "no-multiaz",
      "resourceType" : "AWS::RDS::DBInstance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : "2021-12-03T13:20:58.650Z",
      "updatedIso" : "2021-12-03T15:20:05.725709Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "dbInstanceIdentifier" : "database-test-no-logging-instance-1",
        "dbInstanceClass" : "db.r5.large",
        "engine" : "aurora-mysql",
        "dbInstanceStatus" : "available",
        "automaticRestartTime" : null,
        "masterUsername" : "admin",
        "dbName" : null,
        "endpoint" : {
          "address" : "database-test-no-logging-instance-1.cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
          "port" : 3306,
          "hostedZoneId" : "Z2XHWR1WZ565X2"
        },
        "allocatedStorage" : 1,
        "instanceCreateTime" : "2021-12-03T13:20:58.650Z",
        "preferredBackupWindow" : "09:25-09:55",
        "backupRetentionPeriod" : 1,
        "dbSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "dbParameterGroups" : [ {
          "dbParameterGroupName" : "default.aurora-mysql5.7",
          "parameterApplyStatus" : "in-sync"
        } ],
        "availabilityZone" : "us-east-2b",
        "dbSubnetGroup" : {
          "dbSubnetGroupName" : "default-vpc-6487540f",
          "dbSubnetGroupDescription" : "Created from the RDS Management Console",
          "vpcId" : "vpc-6487540f",
          "subnetGroupStatus" : "Complete",
          "subnets" : [ {
            "subnetIdentifier" : "subnet-249c674f",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2a"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-970130ed",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2b"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-7a198036",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2c"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          } ],
          "dbSubnetGroupArn" : null
        },
        "preferredMaintenanceWindow" : "sun:04:19-sun:04:49",
        "pendingModifiedValues" : {
          "dbInstanceClass" : null,
          "allocatedStorage" : null,
          "masterUserPassword" : null,
          "port" : null,
          "backupRetentionPeriod" : null,
          "multiAZ" : false,
          "engineVersion" : null,
          "licenseModel" : null,
          "iops" : null,
          "dbInstanceIdentifier" : null,
          "storageType" : null,
          "caCertificateIdentifier" : null,
          "dbSubnetGroupName" : null,
          "pendingCloudwatchLogsExports" : null,
          "processorFeatures" : null,
          "iamDatabaseAuthenticationEnabled" : null,
          "automationMode" : null,
          "resumeFullAutomationModeTime" : null
        },
        "latestRestorableTime" : null,
        "multiAZ" : false,
        "engineVersion" : "5.7.mysql_aurora.2.07.2",
        "autoMinorVersionUpgrade" : true,
        "readReplicaSourceDBInstanceIdentifier" : null,
        "readReplicaDBInstanceIdentifiers" : [ ],
        "readReplicaDBClusterIdentifiers" : null,
        "replicaMode" : null,
        "licenseModel" : "general-public-license",
        "iops" : null,
        "optionGroupMemberships" : [ {
          "optionGroupName" : "default:aurora-mysql-5-7",
          "status" : "in-sync"
        } ],
        "characterSetName" : null,
        "ncharCharacterSetName" : null,
        "secondaryAvailabilityZone" : null,
        "publiclyAccessible" : false,
        "statusInfos" : null,
        "storageType" : "aurora",
        "tdeCredentialArn" : null,
        "dbInstancePort" : 0,
        "dbClusterIdentifier" : "database-test-no-logging",
        "storageEncrypted" : true,
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "dbiResourceId" : "db-BPZNLIPBHHNZW4TKGMPXX234ZE",
        "caCertificateIdentifier" : "rds-ca-2019",
        "domainMemberships" : [ ],
        "copyTagsToSnapshot" : false,
        "monitoringInterval" : 60,
        "enhancedMonitoringResourceArn" : "arn:aws:logs:us-east-2:476384142167:log-group:RDSOSMetrics:log-stream:db-BPZNLIPBHHNZW4TKGMPXX234ZE",
        "monitoringRoleArn" : "arn:aws:iam::476384142167:role/rds-monitoring-role",
        "promotionTier" : 1,
        "dbInstanceArn" : "arn:aws:rds:us-east-2:476384142167:db:database-test-no-logging-instance-1",
        "timezone" : null,
        "iamDatabaseAuthenticationEnabled" : false,
        "performanceInsightsEnabled" : true,
        "performanceInsightsKMSKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "performanceInsightsRetentionPeriod" : 7,
        "enabledCloudwatchLogsExports" : null,
        "processorFeatures" : null,
        "deletionProtection" : false,
        "associatedRoles" : [ ],
        "listenerEndpoint" : null,
        "maxAllocatedStorage" : null,
        "tagList" : [ ],
        "dbInstanceAutomatedBackupsReplications" : null,
        "customerOwnedIpEnabled" : false,
        "awsBackupRecoveryPointArn" : null,
        "activityStreamStatus" : null,
        "activityStreamKmsKeyId" : null,
        "activityStreamKinesisStreamName" : null,
        "activityStreamMode" : null,
        "activityStreamEngineNativeAuditFieldsIncluded" : null,
        "automationMode" : null,
        "resumeFullAutomationModeTime" : null,
        "customIamInstanceProfile" : null,
        "backupTarget" : "region"
      },
      "supplementaryConfiguration" : {
        "dbClusters" : {
          "marker" : null,
          "dbClusters" : [ {
            "allocatedStorage" : 1,
            "availabilityZones" : [ "us-east-2b", "us-east-2c", "us-east-2a" ],
            "backupRetentionPeriod" : 1,
            "characterSetName" : null,
            "databaseName" : "",
            "dbClusterIdentifier" : "database-test-no-logging",
            "dbClusterParameterGroup" : "default.aurora-mysql5.7",
            "dbSubnetGroup" : "default-vpc-6487540f",
            "status" : "available",
            "automaticRestartTime" : null,
            "percentProgress" : null,
            "earliestRestorableTime" : "2021-12-03T13:16:25.554Z",
            "endpoint" : "database-test-no-logging.cluster-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "readerEndpoint" : "database-test-no-logging.cluster-ro-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "customEndpoints" : null,
            "multiAZ" : false,
            "engine" : "aurora-mysql",
            "engineVersion" : "5.7.mysql_aurora.2.07.2",
            "latestRestorableTime" : "2021-12-03T15:18:15.145Z",
            "port" : 3306,
            "masterUsername" : "admin",
            "dbClusterOptionGroupMemberships" : null,
            "preferredBackupWindow" : "09:25-09:55",
            "preferredMaintenanceWindow" : "thu:08:51-thu:09:21",
            "replicationSourceIdentifier" : null,
            "readReplicaIdentifiers" : [ ],
            "dbClusterMembers" : [ {
              "dbInstanceIdentifier" : "database-test-no-logging-instance-1",
              "isClusterWriter" : true,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            }, {
              "dbInstanceIdentifier" : "database-test-no-logging-instance-1-us-east-2c",
              "isClusterWriter" : false,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            } ],
            "vpcSecurityGroups" : [ {
              "vpcSecurityGroupId" : "sg-3afa2c42",
              "status" : "active"
            } ],
            "hostedZoneId" : "Z2XHWR1WZ565X2",
            "storageEncrypted" : true,
            "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
            "dbClusterResourceId" : "cluster-LXJKQSHQVDOPXY4LB27E4OEA2U",
            "dbClusterArn" : "arn:aws:rds:us-east-2:476384142167:cluster:database-test-no-logging",
            "associatedRoles" : [ ],
            "iamDatabaseAuthenticationEnabled" : false,
            "cloneGroupId" : null,
            "clusterCreateTime" : "2021-12-03T13:15:40.827Z",
            "earliestBacktrackTime" : null,
            "backtrackWindow" : null,
            "backtrackConsumedChangeRecords" : null,
            "enabledCloudwatchLogsExports" : null,
            "capacity" : null,
            "engineMode" : "provisioned",
            "scalingConfigurationInfo" : null,
            "deletionProtection" : true,
            "httpEndpointEnabled" : false,
            "activityStreamMode" : null,
            "activityStreamStatus" : "stopped",
            "activityStreamKmsKeyId" : null,
            "activityStreamKinesisStreamName" : null,
            "copyTagsToSnapshot" : true,
            "crossAccountClone" : false,
            "domainMemberships" : [ ],
            "tagList" : [ ],
            "globalWriteForwardingStatus" : null,
            "globalWriteForwardingRequested" : null,
            "pendingModifiedValues" : null,
            "dbClusterInstanceClass" : null,
            "storageType" : null,
            "iops" : null,
            "publiclyAccessible" : null,
            "autoMinorVersionUpgrade" : false,
            "monitoringInterval" : null,
            "monitoringRoleArn" : null,
            "performanceInsightsEnabled" : null,
            "performanceInsightsKMSKeyId" : null,
            "performanceInsightsRetentionPeriod" : null
          } ]
        },
        "dbSnapshot" : {
          "marker" : null,
          "dbSnapshots" : [ ]
        },
        "awsBackupJobs" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
secureAssets:
  multiaz: >
    [ {
      "documentId" : "ypKBAozqNu69IzKEIL6EQw",
      "arn" : "multiaz",
      "resourceName" : "multiaz",
      "resourceId" : "multiaz",
      "resourceType" : "AWS::RDS::DBInstance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : "2021-12-03T13:28:14.151Z",
      "updatedIso" : "2021-12-03T13:36:52.252942Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "dbInstanceIdentifier" : "database-testing-logging-instance-1-us-east-2c",
        "dbInstanceClass" : "db.r5.large",
        "engine" : "aurora-mysql",
        "dbInstanceStatus" : "available",
        "automaticRestartTime" : null,
        "masterUsername" : "admin",
        "dbName" : null,
        "endpoint" : {
          "address" : "database-testing-logging-instance-1-us-east-2c.cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
          "port" : 3306,
          "hostedZoneId" : "Z2XHWR1WZ565X2"
        },
        "allocatedStorage" : 1,
        "instanceCreateTime" : "2021-12-03T13:28:14.151Z",
        "preferredBackupWindow" : "05:58-06:28",
        "backupRetentionPeriod" : 1,
        "dbSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "dbParameterGroups" : [ {
          "dbParameterGroupName" : "default.aurora-mysql5.7",
          "parameterApplyStatus" : "in-sync"
        } ],
        "availabilityZone" : "us-east-2c",
        "dbSubnetGroup" : {
          "dbSubnetGroupName" : "default-vpc-6487540f",
          "dbSubnetGroupDescription" : "Created from the RDS Management Console",
          "vpcId" : "vpc-6487540f",
          "subnetGroupStatus" : "Complete",
          "subnets" : [ {
            "subnetIdentifier" : "subnet-249c674f",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2a"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-970130ed",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2b"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-7a198036",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2c"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          } ],
          "dbSubnetGroupArn" : null
        },
        "preferredMaintenanceWindow" : "thu:05:24-thu:05:54",
        "pendingModifiedValues" : {
          "dbInstanceClass" : null,
          "allocatedStorage" : null,
          "masterUserPassword" : null,
          "port" : null,
          "backupRetentionPeriod" : null,
          "multiAZ" : true,
          "engineVersion" : null,
          "licenseModel" : null,
          "iops" : null,
          "dbInstanceIdentifier" : null,
          "storageType" : null,
          "caCertificateIdentifier" : null,
          "dbSubnetGroupName" : null,
          "pendingCloudwatchLogsExports" : null,
          "processorFeatures" : null,
          "iamDatabaseAuthenticationEnabled" : null,
          "automationMode" : null,
          "resumeFullAutomationModeTime" : null
        },
        "latestRestorableTime" : null,
        "multiAZ" : true,
        "engineVersion" : "5.7.mysql_aurora.2.07.2",
        "autoMinorVersionUpgrade" : true,
        "readReplicaSourceDBInstanceIdentifier" : null,
        "readReplicaDBInstanceIdentifiers" : [ ],
        "readReplicaDBClusterIdentifiers" : null,
        "replicaMode" : null,
        "licenseModel" : "general-public-license",
        "iops" : null,
        "optionGroupMemberships" : [ {
          "optionGroupName" : "default:aurora-mysql-5-7",
          "status" : "in-sync"
        } ],
        "characterSetName" : null,
        "ncharCharacterSetName" : null,
        "secondaryAvailabilityZone" : null,
        "publiclyAccessible" : false,
        "statusInfos" : null,
        "storageType" : "aurora",
        "tdeCredentialArn" : null,
        "dbInstancePort" : 0,
        "dbClusterIdentifier" : "database-testing-logging",
        "storageEncrypted" : true,
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "dbiResourceId" : "db-SHCDUBULFGYRSDG2CY5UTDCV3M",
        "caCertificateIdentifier" : "rds-ca-2019",
        "domainMemberships" : [ ],
        "copyTagsToSnapshot" : false,
        "monitoringInterval" : 60,
        "enhancedMonitoringResourceArn" : "arn:aws:logs:us-east-2:476384142167:log-group:RDSOSMetrics:log-stream:db-SHCDUBULFGYRSDG2CY5UTDCV3M",
        "monitoringRoleArn" : "arn:aws:iam::476384142167:role/rds-monitoring-role",
        "promotionTier" : 1,
        "dbInstanceArn" : "arn:aws:rds:us-east-2:476384142167:db:database-testing-logging-instance-1-us-east-2c",
        "timezone" : null,
        "iamDatabaseAuthenticationEnabled" : false,
        "performanceInsightsEnabled" : true,
        "performanceInsightsKMSKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "performanceInsightsRetentionPeriod" : 7,
        "enabledCloudwatchLogsExports" : [ "audit", "error", "general", "slowquery" ],
        "processorFeatures" : null,
        "deletionProtection" : false,
        "associatedRoles" : [ ],
        "listenerEndpoint" : null,
        "maxAllocatedStorage" : null,
        "tagList" : [ ],
        "dbInstanceAutomatedBackupsReplications" : null,
        "customerOwnedIpEnabled" : false,
        "awsBackupRecoveryPointArn" : null,
        "activityStreamStatus" : null,
        "activityStreamKmsKeyId" : null,
        "activityStreamKinesisStreamName" : null,
        "activityStreamMode" : null,
        "activityStreamEngineNativeAuditFieldsIncluded" : null,
        "automationMode" : null,
        "resumeFullAutomationModeTime" : null,
        "customIamInstanceProfile" : null,
        "backupTarget" : "region"
      },
      "supplementaryConfiguration" : {
        "dbClusters" : {
          "marker" : null,
          "dbClusters" : [ {
            "allocatedStorage" : 1,
            "availabilityZones" : [ "us-east-2b", "us-east-2c", "us-east-2a" ],
            "backupRetentionPeriod" : 1,
            "characterSetName" : null,
            "databaseName" : "",
            "dbClusterIdentifier" : "database-testing-logging",
            "dbClusterParameterGroup" : "default.aurora-mysql5.7",
            "dbSubnetGroup" : "default-vpc-6487540f",
            "status" : "available",
            "automaticRestartTime" : null,
            "percentProgress" : null,
            "earliestRestorableTime" : "2021-12-03T13:15:44.334Z",
            "endpoint" : "database-testing-logging.cluster-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "readerEndpoint" : "database-testing-logging.cluster-ro-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "customEndpoints" : null,
            "multiAZ" : true,
            "engine" : "aurora-mysql",
            "engineVersion" : "5.7.mysql_aurora.2.07.2",
            "latestRestorableTime" : "2021-12-03T13:33:08.009Z",
            "port" : 3306,
            "masterUsername" : "admin",
            "dbClusterOptionGroupMemberships" : null,
            "preferredBackupWindow" : "05:58-06:28",
            "preferredMaintenanceWindow" : "thu:03:11-thu:03:41",
            "replicationSourceIdentifier" : null,
            "readReplicaIdentifiers" : [ ],
            "dbClusterMembers" : [ {
              "dbInstanceIdentifier" : "database-testing-logging-instance-1-us-east-2c",
              "isClusterWriter" : false,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            }, {
              "dbInstanceIdentifier" : "database-testing-logging-instance-1",
              "isClusterWriter" : true,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            } ],
            "vpcSecurityGroups" : [ {
              "vpcSecurityGroupId" : "sg-3afa2c42",
              "status" : "active"
            } ],
            "hostedZoneId" : "Z2XHWR1WZ565X2",
            "storageEncrypted" : true,
            "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
            "dbClusterResourceId" : "cluster-YSDF3IE2T6HLIWRDWVEYHRNHZQ",
            "dbClusterArn" : "arn:aws:rds:us-east-2:476384142167:cluster:database-testing-logging",
            "associatedRoles" : [ ],
            "iamDatabaseAuthenticationEnabled" : false,
            "cloneGroupId" : null,
            "clusterCreateTime" : "2021-12-03T13:14:47.303Z",
            "earliestBacktrackTime" : null,
            "backtrackWindow" : null,
            "backtrackConsumedChangeRecords" : null,
            "enabledCloudwatchLogsExports" : [ "audit", "error", "general", "slowquery" ],
            "capacity" : null,
            "engineMode" : "provisioned",
            "scalingConfigurationInfo" : null,
            "deletionProtection" : true,
            "httpEndpointEnabled" : false,
            "activityStreamMode" : null,
            "activityStreamStatus" : "stopped",
            "activityStreamKmsKeyId" : null,
            "activityStreamKinesisStreamName" : null,
            "copyTagsToSnapshot" : true,
            "crossAccountClone" : false,
            "domainMemberships" : [ ],
            "tagList" : [ ],
            "globalWriteForwardingStatus" : null,
            "globalWriteForwardingRequested" : null,
            "pendingModifiedValues" : null,
            "dbClusterInstanceClass" : null,
            "storageType" : null,
            "iops" : null,
            "publiclyAccessible" : null,
            "autoMinorVersionUpgrade" : false,
            "monitoringInterval" : null,
            "monitoringRoleArn" : null,
            "performanceInsightsEnabled" : null,
            "performanceInsightsKMSKeyId" : null,
            "performanceInsightsRetentionPeriod" : null
          } ]
        },
        "dbSnapshot" : {
          "marker" : null,
          "dbSnapshots" : [ ]
        },
        "awsBackupJobs" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
