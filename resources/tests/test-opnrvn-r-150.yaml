ruleId: opnrvn-r-150
description: >
insecureAssets:
  arn:aws:redshift:us-east-2:476384142167:cluster:redshift-test-unencrypted: >
    [ {
      "documentId" : "DbhkopveOk27I-BG_J9_gw",
      "arn" : "arn:aws:redshift:us-east-2:476384142167:cluster:redshift-test-unencrypted",
      "resourceName" : "dev",
      "resourceId" : "redshift-test-unencrypted",
      "resourceType" : "AWS::Redshift::Cluster",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : "2021-12-02T14:20:30.796Z",
      "updatedIso" : "2021-12-02T15:45:15.881345Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "clusterIdentifier" : "redshift-test-unencrypted",
        "nodeType" : "ra3.4xlarge",
        "clusterStatus" : "available",
        "clusterAvailabilityStatus" : "Available",
        "modifyStatus" : null,
        "masterUsername" : "awsuser",
        "dbName" : "dev",
        "endpoint" : {
          "address" : "redshift-test-unencrypted.cb26t3sl5dsd.us-east-2.redshift.amazonaws.com",
          "port" : 5439,
          "vpcEndpoints" : null
        },
        "clusterCreateTime" : "2021-12-02T14:20:30.796Z",
        "automatedSnapshotRetentionPeriod" : 1,
        "manualSnapshotRetentionPeriod" : -1,
        "clusterSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "clusterParameterGroups" : [ {
          "parameterGroupName" : "default.redshift-1.0",
          "parameterApplyStatus" : "in-sync",
          "clusterParameterStatusList" : null
        } ],
        "clusterSubnetGroupName" : "default",
        "vpcId" : "vpc-6487540f",
        "availabilityZone" : "us-east-2b",
        "preferredMaintenanceWindow" : "tue:07:00-tue:07:30",
        "pendingModifiedValues" : {
          "masterUserPassword" : null,
          "nodeType" : null,
          "numberOfNodes" : null,
          "clusterType" : null,
          "clusterVersion" : null,
          "automatedSnapshotRetentionPeriod" : null,
          "clusterIdentifier" : null,
          "publiclyAccessible" : null,
          "enhancedVpcRouting" : null,
          "maintenanceTrackName" : null,
          "encryptionType" : null
        },
        "clusterVersion" : "1.0",
        "allowVersionUpgrade" : true,
        "numberOfNodes" : 2,
        "publiclyAccessible" : false,
        "encrypted" : false,
        "restoreStatus" : null,
        "dataTransferProgress" : null,
        "hsmStatus" : null,
        "clusterSnapshotCopyStatus" : null,
        "clusterPublicKey" : "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCJCPsyTeHj6r37yS1JbOIgfwemdWmmS3BiuiL+S5NB9jH8XqfKa1NuG5CAUjyNweAYpHuKhj7fmi8lEifMN78iLsYD1mISSURs24u2gYlw9KPJFMppqIyvOWhjmgRz1rnvbcuNW/9csv2Blj6ZJ8Q3iMma+zOYMAJ5U/tme3EmfGmx1WiEnXclhlIoEFOYlADmxZiJmiAnJGKRCRjzDo1/C3f98u4OU+8jX34T9Ldrpo7/ZLvIBQ+AzRyn3WXR5EnS+OCXL+QjPpurpY0yCAjpn8ea9pIFSDyxjmviS878P1SkpyHq3pX2SEJNYxF0z953W1vuJ0XLpX0l0FroQMRT Amazon-Redshift\n",
        "clusterNodes" : [ {
          "nodeRole" : "LEADER",
          "privateIPAddress" : "172.31.23.53",
          "publicIPAddress" : "3.139.212.224"
        }, {
          "nodeRole" : "COMPUTE-0",
          "privateIPAddress" : "172.31.17.127",
          "publicIPAddress" : "3.140.83.94"
        }, {
          "nodeRole" : "COMPUTE-1",
          "privateIPAddress" : "172.31.18.207",
          "publicIPAddress" : "52.14.164.5"
        } ],
        "elasticIpStatus" : null,
        "clusterRevisionNumber" : "33759",
        "tags" : [ ],
        "kmsKeyId" : null,
        "enhancedVpcRouting" : false,
        "iamRoles" : [ ],
        "pendingActions" : null,
        "maintenanceTrackName" : "current",
        "elasticResizeNumberOfNodeOptions" : "[3,4,5,6,7,8]",
        "deferredMaintenanceWindows" : [ ],
        "snapshotScheduleIdentifier" : null,
        "snapshotScheduleState" : null,
        "expectedNextSnapshotScheduleTime" : null,
        "expectedNextSnapshotScheduleTimeStatus" : null,
        "nextMaintenanceWindowStartTime" : "2021-12-07T07:00:00Z",
        "resizeInfo" : null,
        "availabilityZoneRelocationStatus" : "disabled",
        "clusterNamespaceArn" : "arn:aws:redshift:us-east-2:476384142167:namespace:f0d5c52a-1dcd-45b7-9e78-75ac801bd70a"
      },
      "supplementaryConfiguration" : {
        "storage" : {
          "totalBackupSizeInMegaBytes" : 0.0,
          "totalProvisionedStorageInMegaBytes" : 0.0
        },
        "PercentageDiskSpaceUsed" : 3.59375E-5
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]

secureAssets:
  arn:aws:redshift:us-east-2:476384142167:cluster:redshift-test-encrypted: >
    [ {
      "documentId" : "v1yhTzzfMa28ZFQXAEM2gA",
      "arn" : "arn:aws:redshift:us-east-2:476384142167:cluster:redshift-test-encrypted",
      "resourceName" : "dev",
      "resourceId" : "redshift-test-encrypted",
      "resourceType" : "AWS::Redshift::Cluster",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : "2021-12-02T15:31:56.853Z",
      "updatedIso" : "2021-12-02T15:45:15.007570Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "clusterIdentifier" : "redshift-test-encrypted",
        "nodeType" : "ra3.4xlarge",
        "clusterStatus" : "available",
        "clusterAvailabilityStatus" : "Available",
        "modifyStatus" : null,
        "masterUsername" : "awsuser",
        "dbName" : "dev",
        "endpoint" : {
          "address" : "redshift-test-encrypted.cb26t3sl5dsd.us-east-2.redshift.amazonaws.com",
          "port" : 5439,
          "vpcEndpoints" : null
        },
        "clusterCreateTime" : "2021-12-02T15:31:56.853Z",
        "automatedSnapshotRetentionPeriod" : 1,
        "manualSnapshotRetentionPeriod" : -1,
        "clusterSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "clusterParameterGroups" : [ {
          "parameterGroupName" : "default.redshift-1.0",
          "parameterApplyStatus" : "in-sync",
          "clusterParameterStatusList" : null
        } ],
        "clusterSubnetGroupName" : "default",
        "vpcId" : "vpc-6487540f",
        "availabilityZone" : "us-east-2b",
        "preferredMaintenanceWindow" : "tue:07:30-tue:08:00",
        "pendingModifiedValues" : {
          "masterUserPassword" : null,
          "nodeType" : null,
          "numberOfNodes" : null,
          "clusterType" : null,
          "clusterVersion" : null,
          "automatedSnapshotRetentionPeriod" : null,
          "clusterIdentifier" : null,
          "publiclyAccessible" : null,
          "enhancedVpcRouting" : null,
          "maintenanceTrackName" : null,
          "encryptionType" : null
        },
        "clusterVersion" : "1.0",
        "allowVersionUpgrade" : true,
        "numberOfNodes" : 2,
        "publiclyAccessible" : false,
        "encrypted" : true,
        "restoreStatus" : null,
        "dataTransferProgress" : null,
        "hsmStatus" : null,
        "clusterSnapshotCopyStatus" : null,
        "clusterPublicKey" : "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCBkfkWkPhq9xIuvkFT977LznnTnvUtkhDbR1ypckTVKQY7RdLHtWgzGnXq5jwuQY50Hhn1pgUOrqNkHUHAvECCXqEqvfrMUej8zHBMlzTJTqQetAONYlG1i8ayLNo89Zf3l3+JchFwvCUPbkCo9vTEHGq1iRFcC44NZx+y2EXPTGv2YJZCfCySbpGOpSKOxyoyuJtre0qNJFOt2tA2AzGez82BOa+Y7vFgDUenHg31WZDeVG0rOVwqbZ8TtShlp/BAWE7nzhoPflLJyRc6bvMpUhMMG+5Q8F5mWAMiyzjOHhp6RSHoV7NXEYPhb/6bwAV55A0D9ek9MevYs+FHCdIz Amazon-Redshift\n",
        "clusterNodes" : [ {
          "nodeRole" : "LEADER",
          "privateIPAddress" : "172.31.25.128",
          "publicIPAddress" : "13.58.83.71"
        }, {
          "nodeRole" : "COMPUTE-0",
          "privateIPAddress" : "172.31.27.3",
          "publicIPAddress" : "52.15.46.103"
        }, {
          "nodeRole" : "COMPUTE-1",
          "privateIPAddress" : "172.31.31.49",
          "publicIPAddress" : "18.116.93.126"
        } ],
        "elasticIpStatus" : null,
        "clusterRevisionNumber" : "33759",
        "tags" : [ ],
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/mrk-e8a318693f4646f9b29494951c37075d",
        "enhancedVpcRouting" : false,
        "iamRoles" : [ {
          "iamRoleArn" : "arn:aws:iam::476384142167:role/service-role/AmazonRedshift-CommandsAccessRole-20211202T142000",
          "applyStatus" : "in-sync"
        } ],
        "pendingActions" : null,
        "maintenanceTrackName" : "current",
        "elasticResizeNumberOfNodeOptions" : "[3,4,5,6,7,8]",
        "deferredMaintenanceWindows" : [ ],
        "snapshotScheduleIdentifier" : null,
        "snapshotScheduleState" : null,
        "expectedNextSnapshotScheduleTime" : null,
        "expectedNextSnapshotScheduleTimeStatus" : null,
        "nextMaintenanceWindowStartTime" : "2021-12-07T07:30:00Z",
        "resizeInfo" : null,
        "availabilityZoneRelocationStatus" : "disabled",
        "clusterNamespaceArn" : "arn:aws:redshift:us-east-2:476384142167:namespace:bd6bbbfa-0223-40b0-a532-995e7268815b"
      },
      "supplementaryConfiguration" : {
        "storage" : {
          "totalBackupSizeInMegaBytes" : 0.0,
          "totalProvisionedStorageInMegaBytes" : 0.0
        },
        "PercentageDiskSpaceUsed" : 3.59375E-5
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
