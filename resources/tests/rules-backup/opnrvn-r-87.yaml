ruleId: opnrvn-r-87
type: asset
ruleName: >
  Ensure Firewall Rules for instances behind Identity Aware Proxy (IAP)
  only allow the traffic from Google Cloud Loadbalancer (GCLB) Health Check and Proxy Addresses
description: >
  IAP ensure that access to VMs is controlled by authenticating incoming requests.
  However if the VM is still accessible from IP addresses other than the IAP it may still be possible to send unauthenticated requests to the instance.
  Care must be taken to ensure that loadblancer health checks are not blocked as this would stop the loadbalancer from correctly knowing the health of the VM and loadbalancing correctly.
manualControl: true
severity: high
enabled: true
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9