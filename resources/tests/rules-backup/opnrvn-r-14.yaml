# id: 463947f9-fafa-4fa1-88a5-dab855928bca
ruleId: opnrvn-r-14
type: asset
ruleName: >
  Ensure IAM password policy prevents password reuse
description: >
  IAM password policies can prevent the reuse of a given password by the same user. It is
  recommended that the password policy prevent the reuse of passwords
severity: high
enabled: true
sql: >
  SELECT asset_id
  FROM magpie.assets
  WHERE resource_type = 'AWS::IAM::Account'
    AND (supplementary_configuration->'passwordPolicy' = 'null'
         OR supplementary_configuration->'passwordPolicy'->'passwordReusePrevention' != '24');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
