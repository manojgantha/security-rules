ruleId: aws-database-rds-automatic-minor-version-upgrade-enabled
cloudProvider: aws
description: >
  Insecure assets have no autoMinorVersionUpgrade enabled
  Secure assets have automatic minor version upgrade enabled on RDS instance
insecureAssets:
  arn:aws:rds:us-east-2:476384142167:db:database-no-auto-mv-instance-1: >
    [{
      "documentId" : "1eGdC8xLOMuGmZs1fCAv6g",
      "arn" : "arn:aws:rds:us-east-2:476384142167:db:database-no-auto-mv-instance-1",
      "resourceName" : "database-no-auto-mv-instance-1",
      "resourceId" : "arn:aws:rds:us-east-2:476384142167:db:database-no-auto-mv-instance-1",
      "resourceType" : "AWS::RDS::DBInstance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : null,
      "updatedIso" : "2021-12-15T13:09:45.674508Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "dbInstanceIdentifier" : "database-no-auto-mv-instance-1",
        "dbInstanceClass" : "db.r5.large",
        "engine" : "aurora-mysql",
        "dbInstanceStatus" : "creating",
        "automaticRestartTime" : null,
        "masterUsername" : "admin",
        "dbName" : null,
        "endpoint" : null,
        "allocatedStorage" : 1,
        "instanceCreateTime" : null,
        "preferredBackupWindow" : "09:53-10:23",
        "backupRetentionPeriod" : 1,
        "dbSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "dbParameterGroups" : [ {
          "dbParameterGroupName" : "default.aurora-mysql5.7",
          "parameterApplyStatus" : "in-sync"
        } ],
        "availabilityZone" : "us-east-2b",
        "dbSubnetGroup" : {
          "dbSubnetGroupName" : "default-vpc-6487540f",
          "dbSubnetGroupDescription" : "Created from the RDS Management Console",
          "vpcId" : "vpc-6487540f",
          "subnetGroupStatus" : "Complete",
          "subnets" : [ {
            "subnetIdentifier" : "subnet-249c674f",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2a"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-970130ed",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2b"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-7a198036",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2c"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          } ],
          "dbSubnetGroupArn" : null
        },
        "preferredMaintenanceWindow" : "wed:08:18-wed:08:48",
        "pendingModifiedValues" : {
          "dbInstanceClass" : null,
          "allocatedStorage" : null,
          "masterUserPassword" : null,
          "port" : null,
          "backupRetentionPeriod" : null,
          "multiAZ" : null,
          "engineVersion" : null,
          "licenseModel" : null,
          "iops" : null,
          "dbInstanceIdentifier" : null,
          "storageType" : null,
          "caCertificateIdentifier" : null,
          "dbSubnetGroupName" : null,
          "pendingCloudwatchLogsExports" : null,
          "processorFeatures" : null,
          "iamDatabaseAuthenticationEnabled" : null,
          "automationMode" : null,
          "resumeFullAutomationModeTime" : null
        },
        "latestRestorableTime" : null,
        "multiAZ" : false,
        "engineVersion" : "5.7.mysql_aurora.2.07.2",
        "autoMinorVersionUpgrade" : false,
        "readReplicaSourceDBInstanceIdentifier" : null,
        "readReplicaDBInstanceIdentifiers" : [ ],
        "readReplicaDBClusterIdentifiers" : null,
        "replicaMode" : null,
        "licenseModel" : "general-public-license",
        "iops" : null,
        "optionGroupMemberships" : [ {
          "optionGroupName" : "default:aurora-mysql-5-7",
          "status" : "in-sync"
        } ],
        "characterSetName" : null,
        "ncharCharacterSetName" : null,
        "secondaryAvailabilityZone" : null,
        "publiclyAccessible" : false,
        "statusInfos" : null,
        "storageType" : "aurora",
        "tdeCredentialArn" : null,
        "dbInstancePort" : 0,
        "dbClusterIdentifier" : "database-no-auto-mv",
        "storageEncrypted" : true,
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "dbiResourceId" : "db-ZCD6BLF6JJ4RB6MXLO7A4T5VXE",
        "caCertificateIdentifier" : "rds-ca-2019",
        "domainMemberships" : [ ],
        "copyTagsToSnapshot" : false,
        "monitoringInterval" : 60,
        "enhancedMonitoringResourceArn" : null,
        "monitoringRoleArn" : "arn:aws:iam::476384142167:role/rds-monitoring-role",
        "promotionTier" : 1,
        "dbInstanceArn" : "arn:aws:rds:us-east-2:476384142167:db:database-no-auto-mv-instance-1",
        "timezone" : null,
        "iamDatabaseAuthenticationEnabled" : false,
        "performanceInsightsEnabled" : true,
        "performanceInsightsKMSKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "performanceInsightsRetentionPeriod" : 7,
        "enabledCloudwatchLogsExports" : null,
        "processorFeatures" : null,
        "deletionProtection" : false,
        "associatedRoles" : [ ],
        "listenerEndpoint" : null,
        "maxAllocatedStorage" : null,
        "tagList" : [ ],
        "dbInstanceAutomatedBackupsReplications" : null,
        "customerOwnedIpEnabled" : false,
        "awsBackupRecoveryPointArn" : null,
        "activityStreamStatus" : null,
        "activityStreamKmsKeyId" : null,
        "activityStreamKinesisStreamName" : null,
        "activityStreamMode" : null,
        "activityStreamEngineNativeAuditFieldsIncluded" : null,
        "automationMode" : null,
        "resumeFullAutomationModeTime" : null,
        "customIamInstanceProfile" : null,
        "backupTarget" : "region"
      },
      "supplementaryConfiguration" : {
        "dbClusters" : {
          "marker" : null,
          "dbClusters" : [ {
            "allocatedStorage" : 1,
            "availabilityZones" : [ "us-east-2b", "us-east-2c", "us-east-2a" ],
            "backupRetentionPeriod" : 1,
            "characterSetName" : null,
            "databaseName" : "",
            "dbClusterIdentifier" : "database-no-auto-mv",
            "dbClusterParameterGroup" : "default.aurora-mysql5.7",
            "dbSubnetGroup" : "default-vpc-6487540f",
            "status" : "available",
            "automaticRestartTime" : null,
            "percentProgress" : null,
            "earliestRestorableTime" : "2021-12-15T13:07:07.385Z",
            "endpoint" : "database-no-auto-mv.cluster-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "readerEndpoint" : "database-no-auto-mv.cluster-ro-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "customEndpoints" : null,
            "multiAZ" : true,
            "engine" : "aurora-mysql",
            "engineVersion" : "5.7.mysql_aurora.2.07.2",
            "latestRestorableTime" : "2021-12-15T13:07:07.385Z",
            "port" : 3306,
            "masterUsername" : "admin",
            "dbClusterOptionGroupMemberships" : null,
            "preferredBackupWindow" : "09:53-10:23",
            "preferredMaintenanceWindow" : "sun:09:06-sun:09:36",
            "replicationSourceIdentifier" : null,
            "readReplicaIdentifiers" : [ ],
            "dbClusterMembers" : [ {
              "dbInstanceIdentifier" : "database-no-auto-mv-instance-1",
              "isClusterWriter" : true,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            }, {
              "dbInstanceIdentifier" : "database-no-auto-mv-instance-1-us-east-2c",
              "isClusterWriter" : false,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            } ],
            "vpcSecurityGroups" : [ {
              "vpcSecurityGroupId" : "sg-3afa2c42",
              "status" : "active"
            } ],
            "hostedZoneId" : "Z2XHWR1WZ565X2",
            "storageEncrypted" : true,
            "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
            "dbClusterResourceId" : "cluster-NK6H6HX7D72AE3AMRUVIIOEFJU",
            "dbClusterArn" : "arn:aws:rds:us-east-2:476384142167:cluster:database-no-auto-mv",
            "associatedRoles" : [ ],
            "iamDatabaseAuthenticationEnabled" : false,
            "cloneGroupId" : null,
            "clusterCreateTime" : "2021-12-15T13:06:23.060Z",
            "earliestBacktrackTime" : null,
            "backtrackWindow" : null,
            "backtrackConsumedChangeRecords" : null,
            "enabledCloudwatchLogsExports" : null,
            "capacity" : null,
            "engineMode" : "provisioned",
            "scalingConfigurationInfo" : null,
            "deletionProtection" : true,
            "httpEndpointEnabled" : false,
            "activityStreamMode" : null,
            "activityStreamStatus" : "stopped",
            "activityStreamKmsKeyId" : null,
            "activityStreamKinesisStreamName" : null,
            "copyTagsToSnapshot" : true,
            "crossAccountClone" : false,
            "domainMemberships" : [ ],
            "tagList" : [ ],
            "globalWriteForwardingStatus" : null,
            "globalWriteForwardingRequested" : null,
            "pendingModifiedValues" : null,
            "dbClusterInstanceClass" : null,
            "storageType" : null,
            "iops" : null,
            "publiclyAccessible" : null,
            "autoMinorVersionUpgrade" : false,
            "monitoringInterval" : null,
            "monitoringRoleArn" : null,
            "performanceInsightsEnabled" : null,
            "performanceInsightsKMSKeyId" : null,
            "performanceInsightsRetentionPeriod" : null
          } ]
        },
        "dbSnapshot" : {
          "marker" : null,
          "dbSnapshots" : [ ]
        },
        "awsBackupJobs" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
secureAssets:
  arn:aws:rds:us-east-2:476384142167:db:database-auto-mv-instance-1: >
    [{
      "documentId" : "e9mAUAfvMoug_fPDmj5oZQ",
      "arn" : "arn:aws:rds:us-east-2:476384142167:db:database-auto-mv-instance-1",
      "resourceName" : "database-auto-mv-instance-1",
      "resourceId" : "arn:aws:rds:us-east-2:476384142167:db:database-auto-mv-instance-1",
      "resourceType" : "AWS::RDS::DBInstance",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : null,
      "updatedIso" : "2021-12-15T13:09:37.411334Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "dbInstanceIdentifier" : "database-auto-mv-instance-1",
        "dbInstanceClass" : "db.r5.large",
        "engine" : "aurora-mysql",
        "dbInstanceStatus" : "creating",
        "automaticRestartTime" : null,
        "masterUsername" : "admin",
        "dbName" : null,
        "endpoint" : null,
        "allocatedStorage" : 1,
        "instanceCreateTime" : null,
        "preferredBackupWindow" : "08:52-09:22",
        "backupRetentionPeriod" : 1,
        "dbSecurityGroups" : [ ],
        "vpcSecurityGroups" : [ {
          "vpcSecurityGroupId" : "sg-3afa2c42",
          "status" : "active"
        } ],
        "dbParameterGroups" : [ {
          "dbParameterGroupName" : "default.aurora-mysql5.7",
          "parameterApplyStatus" : "in-sync"
        } ],
        "availabilityZone" : "us-east-2c",
        "dbSubnetGroup" : {
          "dbSubnetGroupName" : "default-vpc-6487540f",
          "dbSubnetGroupDescription" : "Created from the RDS Management Console",
          "vpcId" : "vpc-6487540f",
          "subnetGroupStatus" : "Complete",
          "subnets" : [ {
            "subnetIdentifier" : "subnet-249c674f",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2a"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-970130ed",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2b"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          }, {
            "subnetIdentifier" : "subnet-7a198036",
            "subnetAvailabilityZone" : {
              "name" : "us-east-2c"
            },
            "subnetOutpost" : {
              "arn" : null
            },
            "subnetStatus" : "Active"
          } ],
          "dbSubnetGroupArn" : null
        },
        "preferredMaintenanceWindow" : "tue:07:44-tue:08:14",
        "pendingModifiedValues" : {
          "dbInstanceClass" : null,
          "allocatedStorage" : null,
          "masterUserPassword" : null,
          "port" : null,
          "backupRetentionPeriod" : null,
          "multiAZ" : null,
          "engineVersion" : null,
          "licenseModel" : null,
          "iops" : null,
          "dbInstanceIdentifier" : null,
          "storageType" : null,
          "caCertificateIdentifier" : null,
          "dbSubnetGroupName" : null,
          "pendingCloudwatchLogsExports" : null,
          "processorFeatures" : null,
          "iamDatabaseAuthenticationEnabled" : null,
          "automationMode" : null,
          "resumeFullAutomationModeTime" : null
        },
        "latestRestorableTime" : null,
        "multiAZ" : false,
        "engineVersion" : "5.7.mysql_aurora.2.07.2",
        "autoMinorVersionUpgrade" : true,
        "readReplicaSourceDBInstanceIdentifier" : null,
        "readReplicaDBInstanceIdentifiers" : [ ],
        "readReplicaDBClusterIdentifiers" : null,
        "replicaMode" : null,
        "licenseModel" : "general-public-license",
        "iops" : null,
        "optionGroupMemberships" : [ {
          "optionGroupName" : "default:aurora-mysql-5-7",
          "status" : "in-sync"
        } ],
        "characterSetName" : null,
        "ncharCharacterSetName" : null,
        "secondaryAvailabilityZone" : null,
        "publiclyAccessible" : false,
        "statusInfos" : null,
        "storageType" : "aurora",
        "tdeCredentialArn" : null,
        "dbInstancePort" : 0,
        "dbClusterIdentifier" : "database-auto-mv",
        "storageEncrypted" : true,
        "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "dbiResourceId" : "db-HJ47FUEWTZHUQTE33KCSLX7ZU4",
        "caCertificateIdentifier" : "rds-ca-2019",
        "domainMemberships" : [ ],
        "copyTagsToSnapshot" : false,
        "monitoringInterval" : 60,
        "enhancedMonitoringResourceArn" : null,
        "monitoringRoleArn" : "arn:aws:iam::476384142167:role/rds-monitoring-role",
        "promotionTier" : 1,
        "dbInstanceArn" : "arn:aws:rds:us-east-2:476384142167:db:database-auto-mv-instance-1",
        "timezone" : null,
        "iamDatabaseAuthenticationEnabled" : false,
        "performanceInsightsEnabled" : true,
        "performanceInsightsKMSKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
        "performanceInsightsRetentionPeriod" : 7,
        "enabledCloudwatchLogsExports" : null,
        "processorFeatures" : null,
        "deletionProtection" : false,
        "associatedRoles" : [ ],
        "listenerEndpoint" : null,
        "maxAllocatedStorage" : null,
        "tagList" : [ ],
        "dbInstanceAutomatedBackupsReplications" : null,
        "customerOwnedIpEnabled" : false,
        "awsBackupRecoveryPointArn" : null,
        "activityStreamStatus" : null,
        "activityStreamKmsKeyId" : null,
        "activityStreamKinesisStreamName" : null,
        "activityStreamMode" : null,
        "activityStreamEngineNativeAuditFieldsIncluded" : null,
        "automationMode" : null,
        "resumeFullAutomationModeTime" : null,
        "customIamInstanceProfile" : null,
        "backupTarget" : "region"
      },
      "supplementaryConfiguration" : {
        "dbClusters" : {
          "marker" : null,
          "dbClusters" : [ {
            "allocatedStorage" : 1,
            "availabilityZones" : [ "us-east-2b", "us-east-2c", "us-east-2a" ],
            "backupRetentionPeriod" : 1,
            "characterSetName" : null,
            "databaseName" : "",
            "dbClusterIdentifier" : "database-auto-mv",
            "dbClusterParameterGroup" : "default.aurora-mysql5.7",
            "dbSubnetGroup" : "default-vpc-6487540f",
            "status" : "available",
            "automaticRestartTime" : null,
            "percentProgress" : null,
            "earliestRestorableTime" : "2021-12-15T13:06:46.988Z",
            "endpoint" : "database-auto-mv.cluster-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "readerEndpoint" : "database-auto-mv.cluster-ro-cr5vsauqrzv3.us-east-2.rds.amazonaws.com",
            "customEndpoints" : null,
            "multiAZ" : false,
            "engine" : "aurora-mysql",
            "engineVersion" : "5.7.mysql_aurora.2.07.2",
            "latestRestorableTime" : "2021-12-15T13:06:46.988Z",
            "port" : 3306,
            "masterUsername" : "admin",
            "dbClusterOptionGroupMemberships" : null,
            "preferredBackupWindow" : "08:52-09:22",
            "preferredMaintenanceWindow" : "sun:10:23-sun:10:53",
            "replicationSourceIdentifier" : null,
            "readReplicaIdentifiers" : [ ],
            "dbClusterMembers" : [ {
              "dbInstanceIdentifier" : "database-auto-mv-instance-1",
              "isClusterWriter" : true,
              "dbClusterParameterGroupStatus" : "in-sync",
              "promotionTier" : 1
            } ],
            "vpcSecurityGroups" : [ {
              "vpcSecurityGroupId" : "sg-3afa2c42",
              "status" : "active"
            } ],
            "hostedZoneId" : "Z2XHWR1WZ565X2",
            "storageEncrypted" : true,
            "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/eb2fb838-797c-402e-9d8f-5f51479b122f",
            "dbClusterResourceId" : "cluster-L37BKJXF33KZV7FSKMRNAKUF5U",
            "dbClusterArn" : "arn:aws:rds:us-east-2:476384142167:cluster:database-auto-mv",
            "associatedRoles" : [ ],
            "iamDatabaseAuthenticationEnabled" : false,
            "cloneGroupId" : null,
            "clusterCreateTime" : "2021-12-15T13:05:36.399Z",
            "earliestBacktrackTime" : null,
            "backtrackWindow" : null,
            "backtrackConsumedChangeRecords" : null,
            "enabledCloudwatchLogsExports" : null,
            "capacity" : null,
            "engineMode" : "provisioned",
            "scalingConfigurationInfo" : null,
            "deletionProtection" : true,
            "httpEndpointEnabled" : false,
            "activityStreamMode" : null,
            "activityStreamStatus" : "stopped",
            "activityStreamKmsKeyId" : null,
            "activityStreamKinesisStreamName" : null,
            "copyTagsToSnapshot" : true,
            "crossAccountClone" : false,
            "domainMemberships" : [ ],
            "tagList" : [ ],
            "globalWriteForwardingStatus" : null,
            "globalWriteForwardingRequested" : null,
            "pendingModifiedValues" : null,
            "dbClusterInstanceClass" : null,
            "storageType" : null,
            "iops" : null,
            "publiclyAccessible" : null,
            "autoMinorVersionUpgrade" : false,
            "monitoringInterval" : null,
            "monitoringRoleArn" : null,
            "performanceInsightsEnabled" : null,
            "performanceInsightsKMSKeyId" : null,
            "performanceInsightsRetentionPeriod" : null
          } ]
        },
        "dbSnapshot" : {
          "marker" : null,
          "dbSnapshots" : [ ]
        },
        "awsBackupJobs" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
