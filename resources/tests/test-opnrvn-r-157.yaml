ruleId: opnrvn-r-157
description: >
  Insecure assets have no CloudWatch logs enabled.
  Secure assets have CloudWatch logs enabled.
insecureAssets:
  arn:aws:es:us-east-2:476384142167:domain/testwithoutlogs: >
    [ {
      "documentId" : "-sG29xXtPiGzJOyIAagosA",
      "arn" : "arn:aws:es:us-east-2:476384142167:domain/testwithoutlogs",
      "resourceName" : "testwithoutlogs",
      "resourceId" : "476384142167/testwithoutlogs",
      "resourceType" : "AWS::Elasticsearch::Domain",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : null,
      "updatedIso" : "2021-12-09T12:38:13.640758Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : 32220000000,
      "sizeInBytes" : 0,
      "configuration" : {
        "domainId" : "476384142167/testwithoutlogs",
        "domainName" : "testwithoutlogs",
        "arn" : "arn:aws:es:us-east-2:476384142167:domain/testwithoutlogs",
        "created" : true,
        "deleted" : false,
        "endpoint" : null,
        "endpoints" : {
          "vpc" : "vpc-testwithoutlogs-7y7fhnn5kh6crifxzlspt3tq4y.us-east-2.es.amazonaws.com"
        },
        "processing" : false,
        "upgradeProcessing" : false,
        "elasticsearchVersion" : "OpenSearch_1.0",
        "elasticsearchClusterConfig" : {
          "instanceType" : "r6g.large.elasticsearch",
          "instanceCount" : 3,
          "dedicatedMasterEnabled" : true,
          "zoneAwarenessEnabled" : true,
          "zoneAwarenessConfig" : {
            "availabilityZoneCount" : 3
          },
          "dedicatedMasterType" : "r6g.large.elasticsearch",
          "dedicatedMasterCount" : 3,
          "warmEnabled" : false,
          "warmType" : null,
          "warmCount" : null,
          "coldStorageOptions" : {
            "enabled" : false
          }
        },
        "ebsOptions" : {
          "ebsEnabled" : true,
          "volumeType" : "gp2",
          "volumeSize" : 10,
          "iops" : null
        },
        "accessPolicies" : "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Deny\",\"Principal\":{\"AWS\":\"*\"},\"Action\":\"es:*\",\"Resource\":\"arn:aws:es:us-east-2:476384142167:domain/testwithoutlogs/*\"}]}",
        "snapshotOptions" : {
          "automatedSnapshotStartHour" : null
        },
        "vpcOptions" : {
          "vpcId" : "vpc-6487540f",
          "subnetIds" : [ "subnet-249c674f", "subnet-7a198036", "subnet-970130ed" ],
          "availabilityZones" : [ "us-east-2a", "us-east-2c", "us-east-2b" ],
          "securityGroupIds" : [ "sg-0320abd8aeb0ae618" ]
        },
        "cognitoOptions" : {
          "enabled" : false,
          "userPoolId" : null,
          "identityPoolId" : null,
          "roleArn" : null
        },
        "encryptionAtRestOptions" : {
          "enabled" : true,
          "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/4c4fde39-14dd-4d62-8173-f3a2fd54d19c"
        },
        "nodeToNodeEncryptionOptions" : {
          "enabled" : true
        },
        "advancedOptions" : {
          "indices.fielddata.cache.size" : "20",
          "override_main_response_version" : "false",
          "indices.query.bool.max_clause_count" : "1024",
          "rest.action.multi.allow_explicit_index" : "true"
        },
        "logPublishingOptions" : null,
        "serviceSoftwareOptions" : {
          "currentVersion" : "R20210816-P3",
          "newVersion" : "R20211203",
          "updateAvailable" : true,
          "cancellable" : false,
          "updateStatus" : "ELIGIBLE",
          "description" : "A newer release R20211203 is available.",
          "automatedUpdateDate" : "1970-01-01T00:00:00Z",
          "optionalDeployment" : true
        },
        "domainEndpointOptions" : {
          "enforceHTTPS" : true,
          "tlsSecurityPolicy" : "Policy-Min-TLS-1-0-2019-07",
          "customEndpointEnabled" : false,
          "customEndpoint" : null,
          "customEndpointCertificateArn" : null
        },
        "advancedSecurityOptions" : {
          "enabled" : true,
          "internalUserDatabaseEnabled" : false,
          "samlOptions" : null
        },
        "autoTuneOptions" : {
          "state" : "ENABLED",
          "errorMessage" : null
        }
      },
      "supplementaryConfiguration" : {
        "clusterUsedSpace" : 0.1446084976196289
      },
      "tags" : { },
      "discoveryMeta" : { }
    }]
secureAssets:
  arn:aws:es:us-east-2:476384142167:domain/testwithlogs: >
    [ {
      "documentId" : "9oAQ61kQMMWV2bDpeQqPmA",
      "arn" : "arn:aws:es:us-east-2:476384142167:domain/testwithlogs",
      "resourceName" : "testwithlogs",
      "resourceId" : "476384142167/testwithlogs",
      "resourceType" : "AWS::Elasticsearch::Domain",
      "awsRegion" : "us-east-2",
      "awsAccountId" : "476384142167",
      "createdIso" : null,
      "updatedIso" : "2021-12-09T12:38:12.544260Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : 32220000000,
      "sizeInBytes" : 0,
      "configuration" : {
        "domainId" : "476384142167/testwithlogs",
        "domainName" : "testwithlogs",
        "arn" : "arn:aws:es:us-east-2:476384142167:domain/testwithlogs",
        "created" : true,
        "deleted" : false,
        "endpoint" : null,
        "endpoints" : {
          "vpc" : "vpc-testwithlogs-vwusqyar53hgpb3ibdmt2xkfdu.us-east-2.es.amazonaws.com"
        },
        "processing" : true,
        "upgradeProcessing" : false,
        "elasticsearchVersion" : "OpenSearch_1.0",
        "elasticsearchClusterConfig" : {
          "instanceType" : "r6g.large.elasticsearch",
          "instanceCount" : 3,
          "dedicatedMasterEnabled" : true,
          "zoneAwarenessEnabled" : true,
          "zoneAwarenessConfig" : {
            "availabilityZoneCount" : 3
          },
          "dedicatedMasterType" : "r6g.large.elasticsearch",
          "dedicatedMasterCount" : 3,
          "warmEnabled" : false,
          "warmType" : null,
          "warmCount" : null,
          "coldStorageOptions" : {
            "enabled" : false
          }
        },
        "ebsOptions" : {
          "ebsEnabled" : true,
          "volumeType" : "gp2",
          "volumeSize" : 10,
          "iops" : null
        },
        "accessPolicies" : "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Deny\",\"Principal\":{\"AWS\":\"*\"},\"Action\":\"es:*\",\"Resource\":\"arn:aws:es:us-east-2:476384142167:domain/testwithlogs/*\"}]}",
        "snapshotOptions" : {
          "automatedSnapshotStartHour" : null
        },
        "vpcOptions" : {
          "vpcId" : "vpc-6487540f",
          "subnetIds" : [ "subnet-249c674f", "subnet-7a198036", "subnet-970130ed" ],
          "availabilityZones" : [ "us-east-2a", "us-east-2c", "us-east-2b" ],
          "securityGroupIds" : [ "sg-0320abd8aeb0ae618" ]
        },
        "cognitoOptions" : {
          "enabled" : false,
          "userPoolId" : null,
          "identityPoolId" : null,
          "roleArn" : null
        },
        "encryptionAtRestOptions" : {
          "enabled" : true,
          "kmsKeyId" : "arn:aws:kms:us-east-2:476384142167:key/4c4fde39-14dd-4d62-8173-f3a2fd54d19c"
        },
        "nodeToNodeEncryptionOptions" : {
          "enabled" : true
        },
        "advancedOptions" : {
          "indices.fielddata.cache.size" : "20",
          "override_main_response_version" : "false",
          "indices.query.bool.max_clause_count" : "1024",
          "rest.action.multi.allow_explicit_index" : "true"
        },
        "logPublishingOptions" : {
          "ES_APPLICATION_LOGS" : {
            "cloudWatchLogsLogGroupArn" : "arn:aws:logs:us-east-2:476384142167:log-group:/aws/OpenSearchService/domains/testwithlogs/application-logs1",
            "enabled" : true
          }
        },
        "serviceSoftwareOptions" : {
          "currentVersion" : "R20210816-P3",
          "newVersion" : "R20211203",
          "updateAvailable" : true,
          "cancellable" : false,
          "updateStatus" : "ELIGIBLE",
          "description" : "A newer release R20211203 is available.",
          "automatedUpdateDate" : "1970-01-01T00:00:00Z",
          "optionalDeployment" : true
        },
        "domainEndpointOptions" : {
          "enforceHTTPS" : true,
          "tlsSecurityPolicy" : "Policy-Min-TLS-1-0-2019-07",
          "customEndpointEnabled" : false,
          "customEndpoint" : null,
          "customEndpointCertificateArn" : null
        },
        "advancedSecurityOptions" : {
          "enabled" : true,
          "internalUserDatabaseEnabled" : false,
          "samlOptions" : null
        },
        "autoTuneOptions" : {
          "state" : "ENABLED",
          "errorMessage" : null
        }
      },
      "supplementaryConfiguration" : {
        "clusterUsedSpace" : 0.1446084976196289
      },
      "tags" : { },
      "discoveryMeta" : { }
     }]
