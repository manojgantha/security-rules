id: 2a66998e-64c2-4ce7-9bf4-c667f06d1efb
ruleId: aws_53
type: asset
ruleName: >
  Ensure that SecurityHub enabled for required region
description: >
  AWS Security Hub gives you a comprehensive view of your security alerts and security posture across your AWS accounts.
  SecurityHub is a single place that manages
severity: medium
enabled: true
sql: >
  SELECT 'No SecurityHub enabled in discovered region: ' || reg.region_global as asset_id
    FROM (SELECT distinct region as region_global
            FROM assets
           WHERE region != 'aws-global') reg
    LEFT JOIN (SELECT region, count (*)
                 FROM assets
             GROUP BY region, resource_type
               HAVING resource_type = 'AWS::SecurityHub::StandardsSubscription' AND count(*) > 0) a
    ON (reg.region_global = a.region or a.region is null)
  WHERE region is null
remediation: >
  Perform the following to enable SecurityHub:
    1. Use the credentials of the IAM identity to sign in to the Security Hub console.
    2. When you open the Security Hub console for the first time, choose Get Started.
    3. On the welcome page, Security standards lists the security standards that Security Hub supports.
    4. To enable a standard, select its check box.. To disable a standard, clear its check box.
    5. Choose Enable Security Hub.
  For details visit: https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-enable.html



