ruleId: aws-storage-s3-versioning-enabled
type: asset
ruleName: >
  Checks if versioning is enabled for your S3 buckets. Optionally, the rule checks if MFA delete is enabled for your S3 buckets.
description: >
  Checks if versioning is enabled for your S3 buckets. Optionally, the rule checks if MFA delete is enabled for your S3 buckets.
severity: high
enabled: true
sql: >
  SELECT arn
  from ${magpie_schema}.awss3bucket
  WHERE
  (supplementaryconfiguration->'Versioning'->>'status' is null
  OR
  supplementaryconfiguration->'Versioning'->>'status' != 'Enabled');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
