ruleId: opnrvn-r-163
type: asset
ruleName: >
  Checks that point in time recovery (PITR) is enabled for Amazon DynamoDB tables.
description: >
  The rule is NON_COMPLIANT if point in time recovery is not enabled for Amazon DynamoDB tables.
severity: high
enabled: true
sql: >
  select asset_id
  FROM assets
  WHERE resource_type = 'AWS::DynamoDB::Table'
  AND supplementary_configuration->'continuousBackups'->'continuousBackupsDescription'->'pointInTimeRecoveryDescription'->>'pointInTimeRecoveryStatus' = 'DISABLED';
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
