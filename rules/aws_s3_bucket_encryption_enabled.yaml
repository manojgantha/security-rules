id: b6b640be-94b6-40fb-8e69-0c3917ffeb4f
ruleId: aws_058
type: asset
ruleName: >
  Ensure S3 bucket has enabled server-side encryption
description: >
  S3 bucket policies allow any uploaded file to be encrypted with AES256,
  or forcing any uploaded file to be encrypted with a specific AWS KMS key.
  This helps prevent S3 ransomware since the attacker should not have access to modify the bucketâ€™s policy.
severity: high
enabled: true
sql: >
  SELECT asset_id
  FROM assets s3bucket
  WHERE s3bucket.resource_type = 'AWS::S3::Bucket'
    AND s3bucket.supplementary_configuration ->> 'serverSideEncryptionConfiguration' IS NULL
remediation: >
  Perform the following to enable S3 bucket logging:
  Via the Management Console
    1. Sign in to the AWS Management Console and open the S3 console at https://console.aws.amazon.com/s3.
    2. In the Buckets list, choose the name of the bucket that you want.
    3. Choose Properties.
    4. Under Default encryption, choose Edit.
    5. To enable or disable server-side encryption, choose Enable or Disable.
    6. Chose the required type: Amazon S3-managed key or AWS KMS CMK and configure it appropriately if required
remediationDocURLs:
  - https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html
version: 0.1.3
