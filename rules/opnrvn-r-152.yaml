ruleId: opnrvn-r-152
type: asset
ruleName: >
  Checks whether Amazon S3 bucket has lock enabled, by default.
description: >
  The rule is NON_COMPLIANT if the lock is not enabled.
severity: high
enabled: true
sql: >
  SELECT asset_id
  from assets
  WHERE resource_type like 'AWS::S3::Bucket'
  AND
  (supplementary_configuration->'bucketObjectLockConfiguration' = 'null'
  OR supplementary_configuration->'bucketObjectLockConfiguration'->>'objectLockEnabled' != 'Enabled');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9