# vid: d8792397-239e-4028-9539-7b3771ba929f
policyId: opnrvn-p-2
policyName:  Google Cloud Security Best Practices
cloudProvider: GCP
description: >
  Google Cloud Security Best Practices analyzes accounts for security best practices and is modelled on guidance published by the Center for Information Security.
enabled: true
rules:
  - gcp-iam-and-security-ensure-oslogin-is-enabled-for-a-project.yaml
#  - opnrvn-r-62.yaml # CIS 1.6 -- IAM
  - gcp-iam-and-security-ensure-only-gcp-managed-service-account-keys-for-each-service-account.yaml # CIS 1.4
#  - opnrvn-r-64.yaml # CIS 1.7
  - gcp-iam-and-security-ensure-that-mfa-is-enabled-for-all-non-service-accounts.yaml # CIS 1.2
#  - opnrvn-r-66.yaml # CIS 1.3
  - gcp-management-tools-ensure-service-account-has-no-admin-privilege.yaml # CIS 1.5
#  - opnrvn-r-68.yaml # CIS 1.8
  - gcp-iam-and-security-ensure-kms-cryptokeys-are-not-anonymously-or-publicly-accessible.yaml # CIS 1.9
#  - opnrvn-r-70.yaml # CIS 1.10
  - gcp-iam-and-security-ensure-separation-of-duties-is-enforced-while-assigning-kms-related-roles-to-users.yaml # CIS 1.11
#  - opnrvn-r-72.yaml # CIS 1.12
  - gcp-iam-and-security-ensure-api-keys-are-restricted-to-use-by-only-specified-hosts-and-apps.yaml # CIS 1.13
#  - opnrvn-r-74.yaml # CIS 1.14
  - gcp-iam-and-security-ensure-api-keys-are-rotated-every-90-days.yaml # CIS 1.15
#  - opnrvn-r-76.yaml # CIS 5.1 -- Storage
  - gcp-storage-buckets-have-uniform-bucket-level-access-enabled.yaml # CIS 5.2
#  - opnrvn-r-78.yaml # CIS 3.1 -- Network
  - gcp-network-and-content-delivery-ensure-legacy-networks-do-not-exist-for-a-project.yaml # CIS 3.2
#  - opnrvn-r-80.yaml # CIS 3.3
  - gcp-network-and-content-delivery-ensure-rsasha1-is-not-used-for-key-signing-key-in-cloud-dns-dnssec.yaml # CIS 3.4
#  - opnrvn-r-82.yaml # CIS 3.5
  - gcp-network-and-content-delivery-ensure-ssh-access-is-restricted-from-the-internet.yaml # CIS 3.6
#  - opnrvn-r-84.yaml # CIS 3.7
  - gcp-network-and-content-delivery-ensure-that-vpc-flow-logs-is-enable-for-every-vpc-network-subnet.yaml # CIS 3.8
#  - opnrvn-r-86.yaml # CIS 3.9
  - gcp-network-and-content-delivery-ensure-firewall-rules-for-instances-behind-iap-only-allow-traffic-from-gclb-addresses.yaml # CIS 3.10
#  - opnrvn-r-88.yaml # CIS 4.1 -- Virtual Machines
  - gcp-compute-ensure-instances-are-not-configured-to-use-the-default-service-account.yaml # CIS 4.2
#  - opnrvn-r-90.yaml # CIS 4.3
  - gcp-compute-ensure-oslogin-is-not-overwritten-by-instance-meta.yaml # CIS 4.4   <- (instance scope rule)
#  - opnrvn-r-92.yaml # CIS 4.5
  - gcp-compute-ensure-ip-forwarding-is-not-enabled-on-instances.yaml # CIS 4.6
#  - opnrvn-r-94.yaml # CIS 4.7
  - gcp-compute-ensure-compute-instances-are-launched-with-shielded-vm-enabled.yaml # CIS 4.8
#  - opnrvn-r-96.yaml # CIS 4.9
  - gcp-compute-ensure-app-engine-applications-enforce-https-connections.yaml # CIS 4.10
#  - opnrvn-r-98.yaml # CIS 4.11
  - gcp-management-tools-ensure-cloud-audit-logging-is-configured-properly-across-all-services-and-all-users-from-a-project.yaml # CIS 2.1 -- Logging and Monitoring -- (automation)
#  - opnrvn-r-100.yaml # CIS 2.2
  - gcp-management-tools-ensure-retention-policies-on-log-buckets-are-configured-using-bucket-lock.yaml # CIS 2.3
#  - opnrvn-r-102.yaml # CIS 2.4
  - gcp-management-tools-ensure-the-log-metric-filter-and-alerts-exist-for-audit-config-changes.yaml # CIS 2.5
#  - opnrvn-r-104.yaml # CIS 2.6
  - gcp-management-tools-ensure-log-metric-filter-and-alerts-exist-for-vpc-firewall-rule-changes.yaml # CIS 2.7
#  - opnrvn-r-106.yaml # CIS 2.8
  - gcp-management-tools-ensure-log-metric-filter-and-alerts-exist-for-vpc-network-changes.yaml # CIS 2.9
#  - opnrvn-r-108.yaml # CIS 2.10
  - gcp-management-tools-ensure-log-metric-filter-and-alerts-exist-for-sql-instance-config-changes.yaml # CIS 2.11
#  - opnrvn-r-110.yaml # CIS 2.12   <- automation required
  - gcp-database-ensure-bigquery-datasets-are-not-anonymously-or-publicly-accessible.yaml # CIS 7.1 -- BigQuery
#  - opnrvn-r-112.yaml # CIS 7.2
  - gcp-database-ensure-that-a-default-cmek-is-specified-for-all-bigquery-data-sets.yaml # CIS 7.3
#  - opnrvn-r-114.yaml # CIS 6.1.1 -- Cloud SQL Database Services  <- MySql
  - gcp-database-ensure-skip-show-database-db-flag-for-cloud-sql-mysql-instance-is-set-to-on.yaml # CIS 6.1.2
#  - opnrvn-r-116.yaml # CIS 6.1.3
  - gcp-database-ensure-that-log-checkpoints-db-flag-for-cloud-sql-postgres-instance-is-set-to-on.yaml # CIS 6.2.1  <- PostgreSQL
#  - opnrvn-r-118.yaml # CIS 6.2.2
  - gcp-database-ensure-the-log-connections-db-flag-for-cloud-sql-postgres-instance-is-set-to-on.yaml # CIS 6.2.3
#  - opnrvn-r-120.yaml # CIS 6.2.4
  - gcp-database-ensure-log-duration-db-flag-for-cloud-sql-postgres-instance-is-set-to-on.yaml # CIS 6.2.5
#  - opnrvn-r-122.yaml # CIS 6.2.6
  - gcp-database-ensure-log-statement-db-flag-for-cloud-sql-postgres-instance-is-set-appropriately.yaml # CIS 6.2.7
#  - opnrvn-r-124.yaml # CIS 6.2.8
  - gcp-database-ensure-log-parser-stats-db-flag-for-cloud-sql-postgres-instance-is-set-to-off.yaml # CIS 6.2.9
#  - opnrvn-r-126.yaml # CIS 6.2.10
  - gcp-database-ensure-log-executor-stats-db-flag-for-cloud-sql-postgres-instance-is-set-to-off.yaml # CIS 6.2.11
#  - opnrvn-r-128.yaml # CIS 6.2.12
  - gcp-database-ensure-the-log-min-messages-db-flag-for-cloud-sql-postgres-instance-is-set-appropriately.yaml # CIS 6.2.13
#  - opnrvn-r-130.yaml # CIS 6.2.14
  - gcp-database-ensure-log-temp-files-db-flag-for-cloud-sql-postgres-instance-is-set-to-on.yaml # CIS 6.2.15
#  - opnrvn-r-132.yaml # CIS 6.2.16
  - gcp-database-ensure-external-scripts-enabled-db-flag-for-cloud-sql-server-instance-is-set-to-off.yaml # CIS 6.3.1  <- SQL Server
#  - opnrvn-r-134.yaml # CIS 6.3.2
  - gcp-database-ensure-user-connections-db-flag-for-cloud-sql-server-instances-is-set-as-appropriate.yaml # CIS 6.3.3
#  - opnrvn-r-136.yaml # CIS 6.3.4
  - gcp-database-ensure-remote-access-db-flag-for-cloud-sql-server-instance-is-set-to-off.yaml # CIS 6.3.5
#  - opnrvn-r-138.yaml # CIS 6.3.6
  - gcp-database-ensure-contained-database-authentication-db-flag-for-cloud-sql-on-the-sql-server-instance-is-set-to-off.yaml # CIS 6.3.7
#  - opnrvn-r-140.yaml # CIS 6.4  <- Generic SQL Database rules
  - gcp-database-ensure-that-cloud-sql-database-instances-are-not-open-to-the-world.yaml # CIS 6.5
#  - opnrvn-r-142.yaml # CIS 6.6
  - gcp-database-ensure-that-cloud-sql-database-instances-are-configured-with-automated-backups.yaml # CIS 6.7
version: 0.9
