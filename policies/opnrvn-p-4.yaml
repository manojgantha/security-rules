# id: 3b08bd0c-d0c6-429f-b5c6-b155786f2966
policyId: opnrvn-p-4
policyName: AWS Ransomware Recovery
cloudProvider: AWS
description: >
  The AWS Ransomware Recovery policy analyzes accounts for logging and backup configurations to determine if it would be possible to understand what happened in an attack and to adequately restore if compromised.
enabled: true
rules:
# rules for logging
  - aws-management-tools-ensure-s3-bucket-access-logging-is-enabled-on-cloudtrail-s3-bucket.yaml
  - aws-management-tools-cloudtrail-cloudwatch-logs-enabled.yaml
  - aws-management-tools-cloudtrail-log-file-validation-enabled.yaml
  - aws-management-tools-cloudtrail-encryption-enabled.yaml
  - aws-network-and-content-delivery-vpc-flow-logs-enabled.yaml
  - aws-management-tools-cloudtrail-enabled-all-regions.yaml
  - aws-management-tools-cloudtrail-log-metric-filter-and-alarm-exist-for-unauthorized-api-calls.yaml
#  - opnrvn-r-28.yaml
  - aws-management-tools-cloudtrail-metric-filter-and-alarm-exist-for-root-account-usage.yaml
  - aws-management-tools-cloudtrail-log-metric-filter-and-alaram-exist-for-iam-policy-changes.yaml
  - aws-management-tools-cloudtrail-ensure-log-metric-filter-and-alarm-exist-for-cloudtrail-config-changes.yaml
#  - opnrvn-r-26.yaml
  - aws-management-tools-cloudtrail-ensure-log-metric-filter-and-alaram-exist-for-disabling-or-deleting-CMKs.yaml
  - aws-management-tools-cloudtrail-log-metric-filter-and-alarm-exist-for-s3-policy-changes.yaml
#  - opnrvn-r-36.yaml
#  - opnrvn-r-32.yaml
#  - opnrvn-r-30.yaml
#  - opnrvn-r-34.yaml
#  - opnrvn-r-38.yaml
# rules for backup (to be added)

version: 0.9